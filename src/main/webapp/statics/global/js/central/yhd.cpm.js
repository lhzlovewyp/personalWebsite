(function(j){function l(g,b){var e=null;var a=g[b];var f=a!=null?a:[];for(var c=0;c<f.length;c++){var d=f[c];if(d&&d.commonScreenImgUrl){e=d;break}}return e}function n(a,b){if(a.attr("data-done")=="1"){return}a.attr("href",b.landingPage).attr("title",b.text).attr("data-done","1").attr("data-ref",b.ref);j("b",a).text(b.text);j("p",a).text(b.nameSubtitle)}function i(a,b){if(a.attr("data-done")=="1"){return}a.attr("alt",b.text).attr("src",b.commonScreenImgUrl).attr("data-done","1");if(a.attr("shortimg")!=null){a.attr("shortimg",b.commonScreenImgUrl)}if(a.attr("wideimg")!=null){a.attr("wideimg",b.commonScreenImgUrl)}if(a.attr("si")!=null){a.attr("si",b.commonScreenImgUrl)}if(a.attr("wi")!=null){a.attr("wi",b.commonScreenImgUrl)}if(a.attr("original")!=null){a.attr("original",b.commonScreenImgUrl)
}}function k(f,e){if(f.size()==0){return}var s=f.data("advsData");var g=f.data("doneAdvCodes")!=null?f.data("doneAdvCodes").split(","):[];if(s!=null){for(var a=0;a<e.length;a++){var d=l(s,e[a]);var t=false;for(var b=0;b<g.length;b++){if(g[b]==e[a]){t=true;break}}if(!t&&d!=null){var u=j("body a[data-advId="+d.regionId+"]");var v=j("body img[data-advId="+d.regionId+"]");if(u.size()>0){for(var c=0;c<u.size();c++){n(u.eq(c),d);i(v.eq(c),d)}g.push(e[a]);f.data("doneAdvCodes",g.join(","))}}}}}function h(e){var t,d,f,r,g;var a=typeof isWidescreen!="undefined"?isWidescreen:false;var c=function(){if(!e||e.size()==0){return}t=e.val();d=(t&&t.length>0)?t.split(","):[];r=(typeof currSiteId=="undefined")?1:currSiteId;f=j.cookie("provinceId");b()};var s=function(p,q){var v="http://p4p.yhd.com/advdolphin/external/saleTypeWeightAd?callback=?";
var o={mcSiteId:r,provinceId:f,codes:p,categoryIds:q,screenType:a?"1":"2"};j.getJSON(v,o,function(u){if(u&&u.status==1){var z=u.value;if(z){var y=e.data("advsData");if(y==null){e.data("advsData",z)}else{y=j.extend(y,z);e.data("advsData",y)}k(e,d)}}})};var b=function(){var p=[];for(var o=0;o<d.length;o++){p.push(d[o]);if(p.length>=20){s(p.join(","),"");p=[]}}if(p.length>0){s(p.join(","),"")}};c()}var m=window.loli||(window.loli={});m.cpm=m.cpm||{};m.cpm.initAjaxReplaceAdvertise=function(a){new h(a)}})(jQuery);