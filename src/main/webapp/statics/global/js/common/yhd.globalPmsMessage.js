(function(a){a(function(){if(typeof(pmsInterfaceCallFlag)!="undefined"&&pmsInterfaceCallFlag=="0"){return}var i=YHDOBJECT.globalVariable().globalPageCode;if(typeof(i)=="undefined"||i==-1){return}var j=window.loli||(window.loli={});j.app=j.app||{};var c=j.app.pms=j.app.pms||{};var d=a.cookie("yihaodian_uid")||undefined,e=URLPrefix.pms,h=URLPrefix.statics+"/global/images/blank.gif";var g=function(){var l={hasWideScreen:(typeof isWidescreen!="undefined"&&isWidescreen==true)?true:false};if(i=="YHD_HOME"){l.hasWideScreen=true}return l},k=function(S){var E=S.infoType,q=S.showTimes,U=S.lTrackerPrefix,v=S.rTrackerPrefix,W=S.buttonTracker,z=S.sourceObject||[],H=S.productList||[],s,Q=[],C=[],r=H.length,w=[],F="",A=[],G="",I=0,D;switch(E){case 164:var T=W+"_"+d;s=z.length;G='<div class="fixed_recommend_btn PMS_message_btn data-tk="'+T+'"><span class="recom_text">您关注的商品到货啦！</span></div>';
D="根据到货商品为您推荐";for(var R=0;R<s;R++){var n=z[R],O=n.productId||0,p=n.cnName,m=n.linkUrl,y=n.picUrl||h,u=n.salePrice||0,K=n.yhdPrice||0,M=U+"_"+O+"_"+R,V=typeof(m)=="undefined"?"":'href="'+m+'" data-tk="'+M+'" target="_blank" ';Q.push('<li><dl class="recom_product"><dd class="pic"><a '+V+'title="'+p+'"><img src="'+y+'" width="115" height="115" alt="'+p+'" /></a></dd>');Q.push("<dt><a "+V+'title="'+p+'">'+p+"</a></dt>");Q.push('<dd class="price"><strong>&yen;'+u+"</strong>");if(u!=K){Q.push("<del>&yen;"+K+"</del>")}Q.push('</dd><dd class="btn"><a '+V+'class="btn_add_cart">查看详情</a></dd></dl></li>')}Q=Q.join("");C.push('<div class="recom_num_scroll_wrap"><div class="recom_num_scroll"><ul class="clearfix">'+Q+'</ul></div><a class="scroll_arrow arrow_prev" href="javascript:void(0);"></a><a class="scroll_arrow arrow_next');
C.push('" href="javascript:void(0);"></a><span class="scroll_num"><em class="cur">1</em>/<em class="total">'+s+"</em></span></div>");C=C.join("");I=164;break;case 165:var n=z[0],P=n.activeId,l=n.deductType||1,L=n.threshOld||0,t=n.couponTitle,x=n.couponLinkUrl,o=n.amount||0,J=n.expiredTime||"0000-00-00",T=W+"_"+d,B,M,V;if(currSiteId==1){B="yhd"}else{if(currSiteId==2){B="yw"}}M=B+"_pmsCoupon_"+P;V=typeof(x)=="undefined"?"":'href="'+x+'" data-tk="'+M+'" target="_blank" ';G='<div class="fixed_vouchers_btn PMS_message_btn"><a class="recom_text" href="'+x+'" target="_blank" data-blank_tk="'+M+'">您有一张满'+L;D="除本品外，本券还适用于这些您可能需要的商品";C.push('<div class="recom_vouchers_wrap"><dl><dd class="vouchers_text"><a '+V+'title="'+t+'""><span class="meet">满');if(l==1){G+="元";C.push('<strong class="yen">&yen;</strong><strong class="price">'+L+" </strong>")
}else{if(l==2){G+="件";C.push('<strong class="price">'+L+" </strong>件")}}G+="减"+o+"元的抵用券！（将过期）</a></div>";C.push('减</span><span class="reduce"><strong class="yen">&yen;</strong><strong class="price">'+o+"</strong></span></a></dd>");C.push('<dd class="text"><a '+V+'title="'+t+'">'+t+"</a></dd>");C.push('<dd class="expiry_date">到期时间：'+J+"</dd></dl></div>");C=C.join("");I=165;break;default:break}for(var R=0;R<r;R++){var N=H[R],O=N.productId||0,p=N.cnName,m=N.linkUrl,y=N.picUrl||h,u=N.salePrice||0,K=N.yhdPrice||0,M=v+"_"+O+"_"+R,V=typeof(m)=="undefined"?"":'href="'+m+'" data-tk="'+M+'" target="_blank"';w.push('<li><dl class="recom_product"><dd class="pic"><a '+V+'title="'+p+'"><img src="'+y+'" width="115" height="115" alt="'+p+'" /></a></dd>');w.push("<dt><a "+V+'title="'+p+'">'+p+"</a></dt>");w.push('<dd class="price"><strong>&yen;'+u+"</strong>");
if(u!=K){w.push("<del>&yen;"+K+"</del>")}w.push('</dd><dd class="btn"><a '+V+'class="btn_add_cart">查看详情</a></dd></dl></li>')}w=w.join("");F='<div class="recom_screen_scroll_wrap"><div class="recom_screen_scroll"><ul class="clearfix">'+w+'</ul></div><a class="scroll_arrow arrow_prev" href="javascript:void(0);"></a><a class="scroll_arrow arrow_next" href="javascript:void(0);"></a><b class="icon_arrow"></b></div>';A.push('<div class="fixed_recommend_main fixed_recommend_main_index wrap" id="globalPMSMessage"><div class="fixed_recommend_wrap"><div class="con"><h3>'+D+'</h3><div class="box clearfix">'+C+F+'</div></div><div class="transparent_bg"></div><span class="close"></span></div>');A.push(G+"</div>");A=A.join("");a("body").append(A);if(I>0){recordTrackInfoWithType("1","pms_"+I)}a("#globalPmsMessageBtn").click(function(){gotracker(2,a("#globalPmsMessageBtn").attr("data-tk"))
});addTrackerToEvent(a("#globalPMSMessage .con"),"data-tk");addTrackerToEvent(a("#globalPMSMessage"),"data-blank_tk");f(E,q)},f=function(r,t){var l=g().hasWideScreen,x=a("#globalPMSMessage"),p=x.find(".fixed_recommend_wrap"),w=x.find(".PMS_message_btn"),v=p.find(".close"),m=/msie ([\d\.]+)/.test(window.navigator.userAgent.toLowerCase())&&parseInt(/msie ([\d\.]+)/.exec(window.navigator.userAgent.toLowerCase())[1])<=6,u=screen.width>=1280?true:false,s=l?(u?5:4):4,q=false;w.animate({bottom:"-1px"},300);if(m){var n=a(window).height();j.delay(window,"scroll",null,function(){var y=a(window).scrollTop();x.css({top:n+y})})}w.click(function(){return;var y=a(this);if(r==164){a.getJSON(e+"/pms/infoRemindClearCookie.do?callback=?")}y.animate({bottom:"-30px"},300,function(){p.show().animate({bottom:"0"},500);
if(!q){switch(r){case 164:var z=new o({scrollId:".recom_num_scroll_wrap",scrollPic:".recom_num_scroll ul",picItem:"li",visible:"1",speed:300}),A=new o({scrollId:".recom_screen_scroll_wrap",scrollPic:".recom_screen_scroll ul",picItem:"li",visible:s,speed:600});z.slide();A.slide();break;case 165:var A=new o({scrollId:".recom_screen_scroll_wrap",scrollPic:".recom_screen_scroll ul",picItem:"li",visible:s,speed:600});A.slide();break;default:break}q=true}if(t==1){y.remove()}})});v.click(function(){p.animate({bottom:"-295px"},500,function(){if(t==0){p.hide();w.animate({bottom:"-1px"},300)}else{p.remove()}})});function o(y){this._config={scrollId:"",scrollPic:"",picItem:"",visible:"",speed:400,indexNum:0};this.config=a.extend(this._config,y)}o.prototype.slide=function(){var y=this.config,O=y.visible,A=y.speed,I=a(y.scrollId),C=I.find(y.scrollPic),L=I.find(".scroll_arrow"),B=I.find(".arrow_prev"),D=I.find(".arrow_next"),H=I.find(".scroll_num"),K=H.find(".cur"),N=C.find(y.picItem),F=N.length,G=N.outerWidth(true),J=Math.ceil(F/O),E=0,z=O*G;
if(J<=1){L.hide();H.hide()}else{D.addClass("arrow_next_click")}I.delegate(".arrow_prev_click","click",function(){E--;M(E)});I.delegate(".arrow_next_click","click",function(){E++;M(E)});function M(P){K.text(P+1);if(P==0){B.removeClass("arrow_prev_click");D.addClass("arrow_next_click")}else{if(P==(J-1)){B.addClass("arrow_prev_click");D.removeClass("arrow_next_click")}else{B.addClass("arrow_prev_click");D.addClass("arrow_next_click")}}C.animate({marginLeft:-z*P},A)}}},b=function(){var o={currSiteId:currSiteId,currSiteType:currSiteType,provinceId:a.cookie("provinceId")||undefined,pageCode:i,productid:a("#productId").val(),merchantId:a("#merchantId").val(),userid:d,searchCategoryId:a("#curCategoryIdToGlobal").val(),searchKeyword:a("#searchword").val(),isLogin:0},l=e+"/pms/infoRemind.do?",m=[];m.push(l);
var n=function(p){o.isLogin=p.result;for(var q in o){var r=o[q];if(typeof(r)!=="undefined"){m.push(q+"="+o[q]+"&")}}m.push("callback=?");l=m.join("");a.getJSON(l,function(t){if(t){var s=t.value[0];if(s&&s&&s.status==1&&s.showFlag==1){k(s)}}})};j.globalCheckLogin(n)};c.message=b;setTimeout(function(){c.message()},3000)})})(jQuery);