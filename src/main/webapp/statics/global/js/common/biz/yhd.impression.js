define("common_impression",["base_observer"],function(c){var b={};var d=[];function a(f){if(typeof(loli.page)=="undefined"){return}f=loli.page.checkTpPage(f);if(!f){return}return loli.page.glSpmcodeToId(null,f[0])}c.subscribe("impressionEvent",function(q){var i=q.attr("data-tpa");var m=document.documentElement.scrollTop||document.body.scrollTop;var n=jQuery("meta[name=tp_page]").attr("content");if(!n){return}var r=a(n);if(!r&&r!="0"){return}var f=n.split(".");var l=0;if(f.length>1){l=f[1]}var h=q.attr("data-ctpa");if(h){i=h}var p={scrollTop:m,w_pt:r,w_pv:l,w_tpa:i};var k=r+"_"+l;if(q){var j=q.data("extFlag");var o=q.attr("data-mrt")||0;if(j!="1"&&o==0){var g=window.loli||{};if(g&&g.extTrackerSend){loli.extTrackerSend.send({type:"1",info:i,others:"area.module",extend:k,paramObj:p})}else{recordTrackInfoWithType("1",i,"area.module",k,p)
}q.data("extFlag",1)}}});b.run=function(f){var g=200,h=null;if(f){d=f}if(d.length<1){d=jQuery("[data-tpa],[data-ctpa]")}setTimeout(function(){e()},500);jQuery(document).bind("scroll",function(){h&&clearTimeout(h);h=setTimeout(function(){e()},g)})};function e(){if(typeof(c)=="object"){var h=new Date().getTime();if(d.length>0){var g=[];var f=0;while(f<d.length){if(loli.isVisual(d[f])&&d[f]&&d[f].style&&d[f].style.display!="none"){c.fire("impressionEvent",jQuery(d[f]));d.splice(f,1)}else{f++}}}}}return b});