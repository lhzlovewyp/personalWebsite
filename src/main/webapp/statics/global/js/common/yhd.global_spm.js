(function(n){var b=".";var k="0";var e="1";var h={TPA:"data-tpa",TPC:"data-tpc",TPI:"tpi",TCS:"data-tcs",TCD:"data-tcd",TCI:"data-tci",PC:"data-pc",TP:"data-tp",TC:"data-tc",TCE:"data-tce",ABTEST:"data-abtest",EXPR_TAG:"a,area,button",TPA_CHILD_SIZE:"data-tpaChildSize",TPC_CHILD_SIZE:"data-tpcChildSize",TC_CHILD_SIZE:"data-tcChildSize",RESULT:{RESULT:"result",TP:"tp",TC:"tc",UNIID:"uniId",PAGETYPE:"pageType",PAGEID:"pageId"}};var i=null,o=null,m=0;var f=window.loli||(window.loli={});var a=f.global.uid;var c={getData:function(s){if(f.isSpider()){return{}}d();if(m==-1||m==2){return null}var r=new l(s);return r.getData()},getNewPageData:function(){d();var u=f.util.url.getParams(location.href)||{};var A=u.tp;var w=u.tc;var x=u.tce;var r=u.abtest;var s=u.ti;var v=u.tps;var z=0;var t=g();if(t&&t.length>0){r=k+b+t;
z=1}var y={tp:A,tc:w,tce:x,abtest:r,unValidAB:z,ti:s,tps:v};return j(y)},reloadPage:function(s){var r=q(window.location.href,s);window.location.href=r},refreshPage:function(r,t){var s=q(r,t);window.location.href=s},openPage:function(u,r,x,t){var s=q(r,u);var v="";if(typeof(x)!="undefined"&&x){v=x}var w="";if(typeof(t)!="undefined"&&t){w=t}window.open(s,v,w)},getABExpParam:function(r){var s="";if(r){s=f.page.getABExpParam(r)}return s}};function q(x,r){if(typeof(x)=="undefined"||!x){return""}var v=typeof(r);if(v=="undefined"||!r){return x}var y=null;if(v=="string"){var w=r;var s=r.indexOf("#");if(s==-1){w="#"+w}y=n(w)}else{if(v=="object"){y=r}}if(!y){return x}var z=f.spm.getData(y);if(z){var t=z.tp;var B=z.tc;var C=z.tce;var u=z.abtestValue;var A={tp:t,tc:B,tce:C,abtest:u};var D=f.util.url.appendParams(x,A);
return D}else{return x}}function d(){var r=n("meta[name=tp_page]").attr("content");r=f.page.checkTpPage(r);if(!r){m=-1;return}i=encodeURI(f.page.glSpmcodeToId(null,r[0]));o=encodeURI(r[1]);if(i&&i=="0"){m=2}}function g(){var r=n("meta[name=global-abtest]");if(r&&r.length>0){return r.attr("content")}return""}function l(s){var r=this;r._dom=s;r._opt={};r.init()}l.prototype={init:function(){var v=this,u=v._dom;if(!u){v.set(h.RESULT.RESULT,0);return}if(!(u instanceof n)){u=n(u)}var w=u.data(h.PC);if(w==1){v.set(h.RESULT.RESULT,1);return}else{if(w==-1){v.set(h.RESULT.RESULT,0);return}}var r=p(u,h.TPA);if(r.length<1){if(i){v.set(h.RESULT.RESULT,1);v.set(h.TPA,0);v.set(h.TPC,0);v.set(h.TPI,0)}else{v.set(h.RESULT.RESULT,0)}return}v.set(h.TPA,r.attr(h.TPA));v.initTpaIndex(r);var z=u.data(h.TPI);if(!z){v.initNewTpaIndex(u,r)
}v.set(h.TPC,u.data(h.TPC));v.set(h.TPI,u.data(h.TPI));var s=p(u,h.TC);if(s&&s.length>0){v.set(h.TC,s.attr(h.TC))}else{v.initTcdIndex(r);var x=p(u,h.TCS);var t=p(u,h.TCD);if(t.length>0){if(!x.attr(h.TCD)){v.initNewTcdIndex(t,r)}v.set(h.TCS,x.attr(h.TCS));v.set(h.TCD,t.attr(h.TCD));v.set(h.TCI,t.data(h.TCI)||1)}}var y=p(u,h.ABTEST);if(y&&y.length>0){v.set(h.ABTEST,y.attr(h.ABTEST))}v.set(h.RESULT.RESULT,1)},rebuildTP:function(s){var r=s.split(b);var u=f.page.glSpmcodeToId("SPM_AREA",r[2]);var t=f.page.glSpmcodeToId("SPM_COM",r[3]);return(r[0]||"0")+b+(r[1]||"0")+b+(u||"0")+b+(t||"0")+b+(r[4]||"0")+b+(r[5]||"0")},rebuildTC:function(s){if(!s){return s}var u=s.split(b);var t=f.page.glSpmcodeToId("SPM_SYSTEM_TYPE",u[0]||"0");var r=f.page.glSpmcodeToId("SPM_DATA_TYPE",u[2]||"0");return t+b+(u[1]||"0")+b+(r||"0")+b+(u[3]||"0")+b+(u[4]||"1")
},rebuildABTest:function(r){return f.page.glABcodeToTag(r)},getData:function(){var L=this,K=n(L._dom);var G=L.get(h.RESULT.RESULT);if(!G){K.data(h.PC,-1);return null}var z=K.data(h.PC);var I="";var E=p(K,h.TCE);if(E&&E.length>0){I=E.attr(h.TCE)}if(z==1){var J=K.data(h.TP);var C=K.data(h.TC);var v=K.data(h.ABTEST);var F={tp:J,tc:C,tce:I,abtest:v};var x=j(F);return x}var s=L.get(h.TPA);var D=L.get(h.TPC);var t=L.get(h.TPI);var B=L.get(h.TCS);var H=L.get(h.TCD);var w=L.get(h.TCI);var C=L.get(h.TC);var r=i+b+o+b+s+b+D+b+t+b+a;var y="";if(C){y=C}else{if(n.trim(B)!=""||n.trim(H)!=""){if(n.trim(B)!=""){y+=B+b}else{y+="0.0"+b}if(n.trim(H)!=""){y+=H+b}else{y+="0.0"+b}y+=w}}r=this.rebuildTP(r);y=this.rebuildTC(y);var A="";var v=L.get(h.ABTEST);if(v){if(v.indexOf(k+b)<0){var u=this.rebuildABTest(v);if(u){A=e+b+u
}}else{A=v}}K.data(h.TP,r);K.data(h.TC,y);K.data(h.ABTEST,A);K.data(h.PC,1);var F={tp:r,tc:y,tce:I,abtest:A};var x=j(F);return x},initTpaIndex:function(u){var s=u.data(h.TPA_CHILD_SIZE);if(s){return}var x=u.find(h.EXPR_TAG);s=1;var y={};for(var A=0,w;w=x[A];A++){w=n(w);var v=p(w,h.TPC);var t=w.data(h.TPI);if(v.length<1){if(!t){w.data(h.TPI,s)}w.data(h.TPC,0);s++}else{var r=v.find(h.EXPR_TAG);if(r.length==0){r=v}var C=v.attr(h.TPC);var B=y[C]||1;for(var z=0,D;D=r[z];z++){n(D).data(h.TPC,C);if(n(D).data(h.TPI)){continue}n(D).data(h.TPI,B);B++}y[C]=B;v.data(h.TPC_CHILD_SIZE,y[C])}}u.data(h.TPA_CHILD_SIZE,s)},initNewTpaIndex:function(w,t){var s=p(w,h.TPC);var u=w.data(h.TPI);if(s.length<1){var r=t.data(h.TPA_CHILD_SIZE);r++;w.data(h.TPC,0);if(!u){w.data(h.TPI,r)}t.data(h.TPA_CHILD_SIZE,r)}else{var v=s.data(h.TPC_CHILD_SIZE)||0;
v++;w.data(h.TPC,s.attr(h.TPC));if(!u){w.data(h.TPI,v)}s.data(h.TPC_CHILD_SIZE,v)}},initTcdIndex:function(r){var v=r.data(h.TC_CHILD_SIZE);if(v!=null){return}var u=r.find("[data-tcd]");for(var s=0,t;t=u[s];s++){t=n(t);t.data(h.TCI,s+1)}r.data(h.TC_CHILD_SIZE,u.length)},initNewTcdIndex:function(t,s){var r=s.data(h.TC_CHILD_SIZE);r++;s.data(h.TC_CHILD_SIZE,r);t.data(h.TCI,r)},get:function(r){return this._opt[r]},set:function(s,r){this._opt[s]=r}};function j(T){var L=T.tce,N=T.abtest,V=T.unValidAB,J=T.ti,P=T.tps;var w=T.tp||"";var t=T.tc||"";var B="";var F="";var z="";var x="";var r="";var R="";var H="";var X="";var D="";var U="";var v="";var A="";var u="";var K="";if(w){w=decodeURIComponent(w);var S=w.split(".");if(S.length>=6&&f.config.isValidUID(S[5])){B=S[2]||"0";F=S[3]||"0";z=S[4]||"0";D=S[0]||"0";
U=S[5]||"0";v=S[1]||"0";if(t){var C=t.split(".");x=C[0]||"0";r=C[1]||"0";R=C[2]||"0";H=C[3]||"0";X=C[4]||"1"}A=N;if(J){var s=S[5].split("-")[0];var G=s+"_"+J;var E=n.cookie(G);if(E){var W=E.split(";");if(W){for(var O=0;O<W.length;O++){var Y=W[O];if(Y&&Y.indexOf(":")>0){var M=Y.split(":");var I=M[0];var y=M[1];if(I=="x"){u=y}else{if(I=="y"){K=y}}}}}n.cookie(G,"",{expires:-1,path:"/",domain:no3wUrl})}}else{if(P&&P.indexOf("x")==0&&P.indexOf("y")>1&&P.indexOf("y")!=P.length-1){var Q=P.indexOf("y");u=P.substring(1,Q);K=P.substring(Q+1)}}}}if(!A&&V){A=N}return{tp:w,tc:t,tpa:B,tpc:F,tpi:z,tcs:x,tcsa:r,tcd:R,tcdt:H,tci:X,tce:L||"",abtestValue:A||"",pageTypeId:i,pageValue:o,unid:a,refPageTypeId:D,refUnid:U,refPageValue:v,eventXRate:u,eventYRate:K}}function p(r,s){return r.closest("["+s+"]")}f.spm=c
})(jQuery);