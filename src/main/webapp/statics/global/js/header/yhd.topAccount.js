(function(b){b(function(){var w=window.loli||(window.loli={});var q=w.app=w.app||{};var n=w.app.account=w.app.account||{};var o=b.cookie("provinceId");var x=b.cookie("yihaodian_uid");var v=(typeof globalTopPrismFlag!="undefined"&&globalTopPrismFlag=="0")?0:1;var t=b("#global_login");var u=t.attr("data-mpIcon")!=""?b.parseJSON(t.attr("data-mpIcon")):null;if(!x||!o){return}var r=function(){var d=URLPrefix.central+"/homepage/ajaxFindPrismMemberUserInfo.do?callback=?";var e=function(g){var f=a(g);t.html(f);t.data("userInfo",g);s()};var c={userId:x,currSiteId:(typeof currSiteId=="undefined")?1:currSiteId,currSiteType:1,provinceId:o};b.getJSON(d,c,function(h){var f=h;if(f){if(f.status==1){var g=f.userInfo;e(g)}}})};var p=function(c){if(c!=null&&c!=""){c=c.replace(/\&/g,"&amp;");c=c.replace(/\</g,"&lt;");
c=c.replace(/\>/g,"&gt;");c=c.replace(/\\/g,"&#92;");c=c.replace(/\'/g,"&#039;");c=c.replace(/\"/g,"&#034;")}return c};var a=function(M){if(!M){return}var h=URLPrefix.statics+"/global/images/top/peopleicon_01.gif";var L=URLPrefix.statics+"/global/images/top/peopleicon_02.gif";var J="http://my.yhd.com/member/my.do";var c="http://vip.yhd.com";var P="http://jifen.yhd.com/pointshop/pointIndex.do";var f="http://my.yhd.com/member/userinfo/editinfo.do";var i="http://vip.yhd.com/badge-shop/index.html";var R="http://edm.yhd.com/pcMsg/myMessage.action";var k=M.endUserCredit?M.endUserCredit:0;var g=M.exp?M.exp:0;var N=M.nextGradeExpNeed;var Q=M.memberGrade?M.memberGrade:0;var m=M.endUserPic;var e=p(M.endUserName);var I=M.badgesNum?M.badgesNum:0;var K=M.msgsNum?M.msgsNum:0;var l=M.samFlag?M.samFlag:0;if(Q==null||Q<0||Q>3){Q=0
}var O=0;if(g<1){O=0}else{if(g<1000){O=g/10}else{if(g<3000){O=g/30}else{O=g>=10000?75:g/10000*0.75*100}}}var d="";if(u!=null&&u.imgUrl!=""){d+="<img src='"+u.imgUrl+"' alt='"+(u.altName||"")+"'>"}var j=[];j.push("<div class='hd_login clearfix'>");j.push("<span class='hd_hi'>Hi,</span>");j.push("<a href='"+c+"' target='_blank' class='hd_vip "+("hd_vip"+Q)+"' data-ref='YHD_TOP_username_vip'></a>");j.push("<a href='"+J+"' target='_blank' class='hd_login_name fl' data-ref='YHD_TOP_myyihaodian'>"+e+"</a>");j.push("</div>");j.push("<div class='hd_user_center'>");j.push("<a href='javascript:bothSiteLogoutJsonp();' class='blue_link'>退出登录</a>");j.push("<div class='clearfix'>");j.push("<div class='fl'>");j.push("<a class='hd_avata_box' href='"+J+"' target='_blank' data-ref='YHD_TOP_userpic'>");j.push(m?"<img src='"+m+"'>":"");
j.push("</a>");j.push("<a href='"+f+"' target='_blank' data-ref='YHD_TOP_userinfo'>个人资料</a>");j.push("</div>");j.push("<div class='hd_growth_box'>");j.push("<p><a class='hd_user_name' href='"+J+"' target='_blank' data-ref='YHD_TOP_myyihaodian'>"+e+"</a>&nbsp;");j.push("<a class='hd_vip "+("hd_vip"+Q)+"' href='"+c+"' target='_blank' data-ref='YHD_TOP_username_vip'></a>");if(l){j.push("<a title='山姆会员' class='hd_sam_vip' href='javascript:;' data-ref='YHD_TOP_usersamicon'></a>")}j.push("</p>");j.push("<p>当前成长值：<a class='hd_login_wrap_arrow' href='"+c+"' target='_blank' data-ref='YHD_TOP_userexp'>"+g+"</a></p>");j.push("<div class='hd_growth_progress'><p class='hd_progress_bar' style='width:"+O+"%'><i></i></p></div>");j.push("</div>");j.push("</div>");j.push("<div class='hd_message'>");j.push("<a href='"+P+"' target='_blank' data-ref='YHD_TOP_userjifen'>");
j.push("<b>"+k+"</b>");j.push("<span class='hd_point'>积分<em>"+d+"</em></span>");j.push("</a>");j.push("<a href='"+c+"' target='_blank' data-ref='YHD_TOP_userxunzhang'>");if(Q==0||Q==3){j.push("<b>0元</b>");j.push("<span>会员价</span>")}else{j.push("<b>19.9元</b>");j.push("<span>会员价</span>")}j.push("</a>");j.push("<a href='"+R+"' target='_blank' data-ref='YHD_TOP_usermsg'>");j.push("<b>"+K+"</b>");j.push("<span>消息</span>");j.push("</a>");j.push("</div>");j.push("</div>");j.push("<em class='hd_login_arrow'></em>");return j.join("")};var s=function(){var c=null;t.hover(function(){var d=w.spm.getData(this);gotracker("2","logintopbarHover",null,d);if(c!=null){clearTimeout(c)}c=setTimeout(function(){t.addClass("hd_login_hover")},200)},function(){if(c!=null){clearTimeout(c)}c=setTimeout(function(){t.removeClass("hd_login_hover")
},200)});t.show();b("#global_unlogin").hide()};n.showUserInfo=function(e){if(v){if(e&&e.result==1){r()}}else{if(e&&e.result==1){var d={endUserName:e.userName,endUserPic:e.endUserPic,endUserSex:e.endUserSex,memberGrade:e.memberGrade,exp:0,nextGradeExpNeed:0,endUserCredit:0,badgesNum:0,msgsNum:0};var c=a(d);t.html(c);t.data("userInfo",d);s()}}};if(t.size()>0&&t.attr("data-type")!=null){w.globalCheckLogin(n.showUserInfo)}})})(jQuery);