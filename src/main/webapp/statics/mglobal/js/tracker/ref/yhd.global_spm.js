define("tracker_ref_yhd.global_spm",["tracker_ref_yhd.uid","util_yhd.url"],function(e,k){var m={};var l=".";var c="0";var p="1";var q={TPA:"tpa",TPC:"tpc",TPI:"tpi",TCS:"tcs",TCD:"tcd",TCI:"tci",PC:"pc",TP:"tp",TC:"tc",ABTEST:"abtest",ABTEST_TAG:"abtest_tag",EXPR_TAG:"a,area,button",TPA_CHILD_SIZE:"tpaChildSize",TPC_CHILD_SIZE:"tpcChildSize",TC_CHILD_SIZE:"tcChildSize",RESULT:{RESULT:"result",TP:"tp",TC:"tc",UNIID:"uniId",PAGETYPE:"pageType",PAGEID:"pageId"}};var r=null,j=null,b=0;var o=e.genUID();m.getData=function(x,v){if(k.isSpider()){return{}}i();if(b==-1||b==2){return null}var w=new h(x,v);return w.getData()};m.getNewPageData=function(){i();var y=k.getParams(location.href)||{};var v=y.tp;var z=y.tc;var A=y.abtest;var x=0;var w=g();if(w&&w.length>0){A=c+l+w;x=1}return f(v,z,A,x)};m.reloadPage=function(v){m.refreshPage(window.location.href,v)
};m.refreshPage=function(x,v,w){var y=a(x,v,w);window.location.href=y};m.openPage=function(A,v,w,x){var z=a(v,A);var B="";if(typeof(w)!="undefined"&&w){B=w}var y="";if(typeof(x)!="undefined"&&x){y=x}window.open(z,B,y)};m.getABExpParam=function(v){var w=u(v);return w};m.glABcodeToTag=function(w){var v=n(w);return v};function a(x,D,G){if(!x){return""}var v=typeof(D);if(v=="undefined"||!D){return x}var z=null;if(v=="string"){var w=D;var C=D.indexOf("#");if(C===-1){w="#"+w}z=$(w)}else{if(v=="object"){z=D}}if(!z){return x}var y=m.getData(z,G);if(y){var E=y.tp;var B=y.tc;var F=y.abtestValue;var H={tp:E,tc:B,abtest:F};var A=k.appendParams(x,H);return A}else{return x}}function d(w,v){if(typeof(_globalSpmDataModelJson)!="undefined"&&_globalSpmDataModelJson){var x=0;if(w){x=_globalSpmDataModelJson[w]?_globalSpmDataModelJson[w][v]:""
}else{x=_globalSpmDataModelJson[v]}if(x){return x}}return v}function i(){var v=$("meta[name=tp_page]").attr("content");v=t(v);if(!v){b=-1;return}r=d(null,v[0]);j=v[1];if(r&&r=="0"){b=2}}function g(){var v=$("meta[name=global-abtest]");if(v&&v.length>0){return v.attr("content")}return""}function n(w){if(w&&w.length>0&&typeof(_globalABTestExpDataJson)!="undefined"&&_globalABTestExpDataJson&&_globalABTestExpDataJson[w]){var v=_globalABTestExpDataJson[w]["tag"];return v}return""}function u(v){if(v&&v.length>0&&typeof(_globalABTestExpDataJson)!="undefined"&&_globalABTestExpDataJson&&_globalABTestExpDataJson[v]){var w=_globalABTestExpDataJson[v]["expParam"];return w}return""}function h(x,v){var w=this;w._dom=x;w._opt={};w.TAG=v||q.EXPR_TAG;w.init()}h.prototype={init:function(){var z=this,y=z._dom;
if(!y){z.set(q.RESULT.RESULT,0);return}if(!(y instanceof $)){y=$(y)}var A=y.data(q.PC);if(A==1){z.set(q.RESULT.RESULT,1);return}else{if(A==-1){z.set(q.RESULT.RESULT,0);return}}var v=s(y,q.TPA);if(v.length<1){if(r){z.set(q.RESULT.RESULT,1);z.set(q.TPA,0);z.set(q.TPC,0);z.set(q.TPI,0)}else{z.set(q.RESULT.RESULT,0)}return}z.set(q.TPA,v.data(q.TPA));z.initTpaIndex(v);var D=y.data(q.TPI);if(!D){z.initNewTpaIndex(y,v)}z.set(q.TPC,y.data(q.TPC));z.set(q.TPI,y.data(q.TPI));var w=s(y,q.TC);if(w&&w.length>0){z.set(q.TC,w.data(q.TC))}else{z.initTcdIndex(v);var B=s(y,q.TCS);var x=s(y,q.TCD);if(x.length>0){if(!B.data(q.TCD)){z.initNewTcdIndex(x,v)}z.set(q.TCS,B.data(q.TCS));z.set(q.TCD,x.data(q.TCD));z.set(q.TCI,x.data(q.TCI)||1)}}var C=s(y,q.ABTEST);if(C&&C.length>0){z.set(q.ABTEST,C.data(q.ABTEST))}z.set(q.RESULT.RESULT,1)
},rebuildTP:function(v){v+="";var y=v.split(l);var x=d("SPM_AREA",y[2]);var w=d("SPM_COM",y[3]);return(y[0]||"0")+l+(y[1]||"0")+l+(x||"0")+l+(w||"0")+l+(y[4]||"0")+l+(y[5]||"0")},rebuildTC:function(v){if(!v){return v}v+="";var x=v.split(l);var w=d("SPM_SYSTEM_TYPE",x[0]||"0");var y=d("SPM_DATA_TYPE",x[2]||"0");return w+l+(x[1]||"0")+l+(y||"0")+l+(x[3]||"0")+l+(x[4]||"1")},getData:function(){var M=this,L=$(M._dom);var E=M.get(q.RESULT.RESULT);if(!E){L.data(q.PC,-1);return null}var v=L.data(q.PC);if(v==1){var J=L.data(q.TP);var K=L.data(q.TC);var I=L.data(q.ABTEST_TAG);var B=f(J,K,I);return B}var w=M.get(q.TPA);var G=M.get(q.TPC);var D=M.get(q.TPI);var A=M.get(q.TCS);var C=M.get(q.TCD);var F=M.get(q.TCI);var K=M.get(q.TC);var H=r+l+j+l+w+l+(G||"0")+l+D+l+o;var y="";if(K){y=K}else{if($.trim(A)!=""||$.trim(C)!=""){if($.trim(A)!=""){y+=A+l
}else{y+="0.0"+l}if($.trim(C)!=""){y+=C+l}else{y+="0.0"+l}y+=F}}y=this.rebuildTC(y);H=this.rebuildTP(H);var z="";var I=M.get(q.ABTEST);if(I){if(I.indexOf(c+l)<0){var x=n(I);if(x){z=p+l+x}}else{z=I}}L.data(q.TP,H);L.data(q.TC,y);L.data(q.ABTEST_TAG,z);L.data(q.PC,1);var B=f(H,y,z);return B},initTpaIndex:function(G){var E=G.data(q.TPA_CHILD_SIZE);var F=this;if(E){return}var x=G.find(F.TAG);E=1;var y={};for(var A=0,w;w=x[A];A++){w=$(w);var H=s(w,q.TPC);if(H.length<1){w.data(q.TPI,E);w.data(q.TPC,0);E++}else{var C=H.find(F.TAG);if(C.length==0){C=H}var D=H.data(q.TPC);var B=y[D]||1;for(var z=0,v;v=C[z];z++){if($(v).data(q.TPI)){continue}$(v).data(q.TPC,D);$(v).data(q.TPI,B);B++}y[D]=B+C.length;H.data(q.TPC_CHILD_SIZE,y[D])}}G.data(q.TPA_CHILD_SIZE,E)},initNewTpaIndex:function(w,z){var y=s(w,q.TPC);
if(y.length<1){var x=z.data(q.TPA_CHILD_SIZE);x++;w.data(q.TPC,0);w.data(q.TPI,x);z.data(q.TPA_CHILD_SIZE,x)}else{var v=y.data(q.TPC_CHILD_SIZE);v++;w.data(q.TPC,y.data(q.TPC));w.data(q.TPI,v);y.data(q.TPC_CHILD_SIZE,v)}},initTcdIndex:function(z){var y=z.data(q.TC_CHILD_SIZE);if(y!=null){return}var x=z.find("[data-tcd]");for(var v=0,w;w=x[v];v++){w=$(w);w.data(q.TCI,v+1)}z.data(q.TC_CHILD_SIZE,x.length)},initNewTcdIndex:function(x,w){var v=w.data(q.TC_CHILD_SIZE);v++;w.data(q.TC_CHILD_SIZE,v);x.data(q.TCI,v)},get:function(v){return this._opt[v]},set:function(w,v){this._opt[w]=v}};function f(H,I,v,E){var H=H||"";var I=I||"";var w="";var G="";var D="";var B="";var z="";var M="";var M="";var x="";var C="";var L="";var F="";var A="";var y="";if(H){var J=H.split(".");if(J.length>=6&&e.isValidUID(J[5])){w=J[2]||"0";
G=J[3]||"0";D=J[4]||"0";L=J[0]||"0";F=J[5]||"0";A=J[1]||"0";if(I){var K=I.split(".");B=K[0]||"0";z=K[1]||"0";M=K[2]||"0";x=K[3]||"0";C=K[4]||"1"}y=v}}if(!y&&E){y=v}return{tp:H,tc:I,tpa:w,tpc:G,tpi:D,tcs:B,tcsa:z,tcd:M,tcdt:x,tci:C,abtestValue:y||"",pageTypeId:r,pageValue:j,unid:o,refPageTypeId:L,refUnid:F,refPageValue:A}}function t(w){if(!w){return null}var v=w.split(l);return v.length==2?v:null}function s(v,w){return v.closest("[data-"+w+"]")}return m});