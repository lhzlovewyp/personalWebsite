define("common_popupTips",["common_mcookie","global_env","util_yhd.url","common_popupWindow"],function(c,i,f,n){var m,h,k;var e={};var j=0;var d=URLPrefix.index||"http://m.yhd.com";e.getGeo=function(r,q,p){m=r;h=q;k=p;var s=i.getProvinceId();if(s){if(s<1||s>32){i.setProvinceId("")}else{return}}if(navigator.geolocation){var o=navigator.geolocation.getCurrentPosition(a,b,{timeout:2000})}else{l()}};function l(){$.ajax({url:d+"/mobile/homePage/ajaxGetProvinceIdByIPV2.do",dataType:"jsonp",jsonpCallback:"jsonp"+new Date().getTime(),success:function(q){if(q){var r=q.provinceId;if(i.isValidProvinceId(r)){var p=location.href;p=f.appendParams(p,{fixedproid:r});var o=e.proviceObj["p_"+r];n.getLocationPopup(k,{title:"获取定位",closeBtn:true,content:"1号店要使用您当前的位置:"+o,btnGeneral:{text:"手动选择",url:d+"/province"},btnHighlight:{text:"好",url:p}});
$(".btn_highlight").on("click",function(){i.setProvinceId(r)})}else{g();return}}else{g();return}},error:function(){g()}})}function g(){n.getLocationPopup(k,{title:"收货省份",closeBtn:true,content:"请手动选择收货省份",btnGeneral:{text:"取消",url:"javascript:;;"},btnHighlight:{text:"手动选择",url:d+"/province"}});$(".btn_general").on("click",function(){n.closePopup()})}e.proviceObj={p_1:"上海",p_2:"北京",p_3:"天津",p_4:"河北",p_5:"江苏",p_6:"浙江",p_7:"重庆",p_8:"内蒙古",p_9:"辽宁",p_10:"吉林",p_11:"黑龙江",p_12:"四川",p_13:"安徽",p_14:"福建",p_15:"江西",p_16:"山东",p_17:"河南",p_18:"湖北",p_19:"湖南",p_20:"广东",p_21:"广西",p_22:"海南",p_23:"贵州",p_24:"云南",p_25:"西藏",p_26:"陕西",p_27:"甘肃",p_28:"青海",p_29:"新疆",p_30:"宁夏",p_32:"山西"};var a=function(o){var q=o.coords.latitude;var p=o.coords.longitude;$.ajax({url:d+"/mobile/homePage/getProvinceidBygeoV2.do?latitude="+q+"&longitude="+p,dataType:"jsonp",jsonpCallback:"jsonp"+new Date().getTime(),success:function(u){var t=u.cityName;
var s=u.proId;var r=u.referer;if(r.indexOf("&")>0||r.indexOf("?")>0){r+="&fixedproid="+s}else{r+="?fixedproid="+s}if(t!="上海"&&s!="1"){i.setProvinceId(s);location.href=r}else{i.setProvinceId(s)}}})};var b=function(o){if(j==0){l()}j=1};return e});