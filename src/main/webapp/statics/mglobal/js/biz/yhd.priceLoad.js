define([pathurl+"/mglobal/js/biz/yhd.productInfo.js",pathurl+"/mglobal/js/lib/template/ejs"],function(a,c){var b=function(f){var e=f,d={lazyLoadDelay:500,load:true,oneOffLoad:false,scrollLoad:true,productType:"general",callbackHtml:null,parentId:"",productIds:""};$.extend(d,e);this.param=d};b.prototype={constructor:b,isBusy:false,doc:document,priceArray:[],lazyPrice:function(f,e){var h=this,d=h.param;if(e){h.param=$.extend(d,e)}var g=f;if(d.oneOffLoad){h._lazyPrice(d);return f}if(d.load){h._lazyPrice(d)}if(d.scrollLoad){h._iniLazy(function(){h._lazyPrice(d)})}},_loadPrice:function(){var f=this,d=f.param,e=d.lazyLoadDelay;(function(i,h){var g=setInterval(function(){if(i.isBusy){return false}i._priceLoad()},h)})(f,e)},_lazyPrice:function(d,e){_this=this;_this.isBusy=true;_this._priceLoad()},_priceLoad:function(){var d={};
d.productType=this.param.productType;d.ids=this.param.productIds;a.getProductInfo(d,function(f){var e=new c({url:template}).render(f);$("#"+parentId).html(e);this.isBusy=false})},_iniLazy:function(d){var e=this;$(window).bind("scroll",function(){if(!e.isBusy){d()}else{}})}}});