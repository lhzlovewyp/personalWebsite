define(["common_touch"],function(b){var a={init:function(d){for(var e in d){this[e]=d[e]}var c=this;this.lastMoved=null;if(!this.outer||!this.inner){return false}this.setStyle();b({element:c.outer,start:function(f){c.start(f)},move:function(j,h,i,g,f,k){c.move(j,h,i,g,f,k)},end:function(){c.end()},sliceEnd:function(f){c.sliceEnd(f)}})},setStyle:function(){var c=this.outer,d=this.prefix;this._setY(this.inner,0)},start:function(c){if(!!this.moving){return false}this.touchstartY=this._getY(this.inner);this.movedDis=0;this._transiton(false)},move:function(i,g,h,f,d,j){if(g==="lr"||g==="rl"){this.touchstartY=null;return}if(!!this.moving){return false}if(this.touchstartY==null){this.start();this.movedDis=f;return}var c=f-this.movedDis+this.touchstartY;if(c>=0){c=0}this.move2Pos(c)},end:function(){this.movedDis=0;
this.touchstartY=null},sliceEnd:function(j){if(!!this.moving){return false}var d=this.outer.clientHeight,f=this.inner.clientHeight;var k=this;var e=j.y;var i=Math.abs(j.y);var h=this._getY(this.inner);var g=h;if(i>0.5){var c=(i/j.y)*200;g=h+c}else{g=h}if(!g){return false}if(g>=0){g=0;this.atTop&&this.atTop.apply(null)}if(Math.abs(g)+d>=f){g=-(f-d);this.atEnd&&this.atEnd.apply(null)}this._transiton(true);this.move2Pos(g)},move2Pos:function(c,d){this._setY(this.inner,c);if(d){return}this.onMove&&this.onMove.apply(this,[c])},scroll2Pos:function(c,f){f=f||500;var e=this;var d=this._getY(this.inner);this._transiton(true);this.move2Pos(c)},_setX:function(c,d){if(!c){return false}c.style.webkitTransform="translateX("+d+"px)"},_getX:function(c){if(!c){return false}return parseFloat(c.style.webkitTransform.replace("translateX(",""))
},_setY:function(c,d){if(!c){return false}d=~~d;c.style.webkitTransform="translate3d(0px,"+d+"px,0px)"},_getY:function(d){if(!d){return false}var c;d.style.webkitTransform.replace(/[\w(\.\s]*,{1}\s*(-?\d+\.?\d*)\s*[\w,\.]*/,function(e,f){c=~~f});return c},_transiton:function(c){if(c){this.inner.style.webkitTransition="-webkit-transform 0.4s"}else{this.inner.style.webkitTransition=""}}};return a});