!function(d,c){"function"==typeof define&&(define.amd||define.cmd)?define("libs_jweixin",function(){return c(d)}):c(d,!0)}(this,function(af,ae){function ad(a,f,e){af.WeixinJSBridge?WeixinJSBridge.invoke(a,ab(f),function(b){Z(a,b,e)}):W(a,e)}function ac(a,f,e){af.WeixinJSBridge?WeixinJSBridge.on(a,function(b){e&&e.trigger&&e.trigger(b),Z(a,b,f)}):e?W(a,e):W(a,f)}function ab(b){return b=b||{},b.appId=D.appId,b.verifyAppId=D.appId,b.verifySignType="sha1",b.verifyTimestamp=D.timestamp+"",b.verifyNonceStr=D.nonceStr,b.verifySignature=D.signature,b}function aa(c){var e=c.timestamp+"";var f=c.nonceStr;var d=c["package"];var g=c.paySign;var b=c.signType||"SHA1";return{timeStamp:e,nonceStr:f,"package":d,paySign:g,signType:b}}function Z(h,g,l){var k,j,i;switch(delete g.err_code,delete g.err_desc,delete g.err_detail,k=g.errMsg,k||(k=g.err_msg,delete g.err_msg,k=Y(h,k),g.errMsg=k),l=l||{},l._complete&&(l._complete(g),delete l._complete),k=g.errMsg||"",D.debug&&!l.isInnerInvoke&&alert(JSON.stringify(g)),j=k.indexOf(":"),i=k.substring(j+1)){case"ok":l.success&&l.success(g);
break;case"cancel":l.cancel&&l.cancel(g);break;default:l.fail&&l.fail(g)}l.complete&&l.complete(g)}function Y(h,g){var j,i,l=h,k=Q[l];return k&&(l=k),j="ok",g&&(i=g.indexOf(":"),j=g.substring(i+1),"confirm"==j&&(j="ok"),"failed"==j&&(j="fail"),-1!=j.indexOf("failed_")&&(j=j.substring(7)),-1!=j.indexOf("fail_")&&(j=j.substring(5)),j=j.replace(/_/g," "),j=j.toLowerCase(),("access denied"==j||"no permission to execute"==j)&&(j="permission denied"),"config"==l&&"function not exist"==j&&(j="ok"),""==j&&(j="fail")),g=l+":"+j}function X(g){var f,j,i,h;if(g){for(f=0,j=g.length;j>f;++f){i=g[f],h=R[i],h&&(g[f]=h)}return g}}function W(e,d){if(!(!D.debug||d&&d.isInnerInvoke)){var f=Q[e];f&&(e=f),d&&d._complete&&delete d._complete,console.log('"'+e+'",',d||"")}}function V(){if(!("6.0.2">G||E.systemType<0)){var a=new Image;
E.appId=D.appId,E.initTime=F.initEndTime-F.initStartTime,E.preVerifyTime=F.preVerifyEndTime-F.preVerifyStartTime,L.getNetworkType({isInnerInvoke:!0,success:function(b){E.networkType=b.networkType;var d="https://open.weixin.qq.com/sdk/report?v="+E.version+"&o="+E.isPreVerifyOk+"&s="+E.systemType+"&c="+E.clientVersion+"&a="+E.appId+"&n="+E.networkType+"&i="+E.initTime+"&p="+E.preVerifyTime+"&u="+E.url;a.src=d}})}}function U(){return(new Date).getTime()}function T(a){J&&(af.WeixinJSBridge?a():O.addEventListener&&O.addEventListener("WeixinJSBridgeReady",a,!1))}function S(){L.invoke||(L.invoke=function(a,f,e){af.WeixinJSBridge&&WeixinJSBridge.invoke(a,ab(f),e)},L.on=function(a,d){af.WeixinJSBridge&&WeixinJSBridge.on(a,d)})}var R,Q,O,M,K,J,I,H,G,F,E,D,P,N,L;if(!af.jWeixin){return R={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},Q=function(){var c,d={};
for(c in R){d[R[c]]=c}return d}(),O=af.document,M=O.title,K=navigator.userAgent.toLowerCase(),J=-1!=K.indexOf("micromessenger"),I=-1!=K.indexOf("android"),H=-1!=K.indexOf("iphone")||-1!=K.indexOf("ipad"),G=function(){var b=K.match(/micromessenger\/(\d+\.\d+\.\d+)/)||K.match(/micromessenger\/(\d+\.\d+)/);return b?b[1]:""}(),F={initStartTime:U(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},E={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:H?1:I?2:-1,clientVersion:G,url:encodeURIComponent(location.href)},D={},P={_completes:[]},N={state:0,res:{}},T(function(){F.initEndTime=U()}),L={config:function(d){D=d,W("config",d);var c=D.check===!1?!1:!0;T(function(){var b,g,f;if(c){ad(R.config,{verifyJsApiList:X(D.jsApiList)},function(){P._complete=function(h){F.preVerifyEndTime=U(),N.state=1,N.res=h
},P.success=function(){E.isPreVerifyOk=0},P.fail=function(h){P._fail?P._fail(h):N.state=-1};var e=P._completes;return e.push(function(){D.debug||V()}),P.complete=function(){for(var h=0,a=e.length;a>h;++h){e[h]()}P._completes=[]},P}()),F.preVerifyStartTime=U()}else{for(N.state=1,b=P._completes,g=0,f=b.length;f>g;++g){b[g]()}P._completes=[]}}),D.beta&&S()},ready:function(b){0!=N.state?b():(P._completes.push(b),!J&&D.debug&&b())},error:function(b){"6.0.2">G||(-1==N.state?b(N.res):P._fail=b)},checkJsApi:function(d){var c=function(f){var h,g,e=f.checkResult;for(h in e){g=Q[h],g&&(e[g]=e[h],delete e[h])}return f};ad("checkJsApi",{jsApiList:X(d.jsApiList)},function(){return d._complete=function(b){if(I){var e=b.checkResult;e&&(b.checkResult=JSON.parse(e))}b=c(b)},d}())},onMenuShareTimeline:function(b){ac(R.onMenuShareTimeline,{complete:function(){ad("shareTimeline",{title:b.title||M,desc:b.title||M,img_url:b.imgUrl||"",link:b.link||location.href,type:b.type||"link",data_url:b.dataUrl||""},b)
}},b)},onMenuShareAppMessage:function(b){ac(R.onMenuShareAppMessage,{complete:function(){ad("sendAppMessage",{title:b.title||M,desc:b.desc||"",link:b.link||location.href,img_url:b.imgUrl||"",type:b.type||"link",data_url:b.dataUrl||""},b)}},b)},onMenuShareQQ:function(b){ac(R.onMenuShareQQ,{complete:function(){ad("shareQQ",{title:b.title||M,desc:b.desc||"",img_url:b.imgUrl||"",link:b.link||location.href},b)}},b)},onMenuShareWeibo:function(b){ac(R.onMenuShareWeibo,{complete:function(){ad("shareWeiboApp",{title:b.title||M,desc:b.desc||"",img_url:b.imgUrl||"",link:b.link||location.href},b)}},b)},onMenuShareQZone:function(b){ac(R.onMenuShareQZone,{complete:function(){ad("shareQZone",{title:b.title||M,desc:b.desc||"",img_url:b.imgUrl||"",link:b.link||location.href},b)}},b)},startRecord:function(b){ad("startRecord",{},b)
},stopRecord:function(b){ad("stopRecord",{},b)},onVoiceRecordEnd:function(b){ac("onVoiceRecordEnd",b)},playVoice:function(b){ad("playVoice",{localId:b.localId},b)},pauseVoice:function(b){ad("pauseVoice",{localId:b.localId},b)},stopVoice:function(b){ad("stopVoice",{localId:b.localId},b)},onVoicePlayEnd:function(b){ac("onVoicePlayEnd",b)},uploadVoice:function(b){ad("uploadVoice",{localId:b.localId,isShowProgressTips:0==b.isShowProgressTips?0:1},b)},downloadVoice:function(b){ad("downloadVoice",{serverId:b.serverId,isShowProgressTips:0==b.isShowProgressTips?0:1},b)},translateVoice:function(b){ad("translateVoice",{localId:b.localId,isShowProgressTips:0==b.isShowProgressTips?0:1},b)},chooseImage:function(b){ad("chooseImage",{scene:"1|2",count:b.count||9,sizeType:b.sizeType||["original","compressed"],sourceType:b.sourceType||["album","camera"]},function(){return b._complete=function(d){if(I){var c=d.localIds;
c&&(d.localIds=JSON.parse(c))}},b}())},previewImage:function(b){ad(R.previewImage,{current:b.current,urls:b.urls},b)},uploadImage:function(b){ad("uploadImage",{localId:b.localId,isShowProgressTips:0==b.isShowProgressTips?0:1},b)},downloadImage:function(b){ad("downloadImage",{serverId:b.serverId,isShowProgressTips:0==b.isShowProgressTips?0:1},b)},getNetworkType:function(d){var c=function(g){var j,i,h,f=g.errMsg;if(g.errMsg="getNetworkType:ok",j=g.subtype,delete g.subtype,j){g.networkType=j}else{switch(i=f.indexOf(":"),h=f.substring(i+1)){case"wifi":case"edge":case"wwan":g.networkType=h;break;default:g.errMsg="getNetworkType:fail"}}return g};ad("getNetworkType",{},function(){return d._complete=function(b){b=c(b)},d}())},openLocation:function(b){ad("openLocation",{latitude:b.latitude,longitude:b.longitude,name:b.name||"",address:b.address||"",scale:b.scale||28,infoUrl:b.infoUrl||""},b)
},getLocation:function(b){b=b||{},ad(R.getLocation,{type:b.type||"wgs84"},function(){return b._complete=function(c){delete c.type},b}())},hideOptionMenu:function(b){ad("hideOptionMenu",{},b)},showOptionMenu:function(b){ad("showOptionMenu",{},b)},closeWindow:function(b){b=b||{},ad("closeWindow",{immediate_close:b.immediateClose||0},b)},hideMenuItems:function(b){ad("hideMenuItems",{menuList:b.menuList},b)},showMenuItems:function(b){ad("showMenuItems",{menuList:b.menuList},b)},hideAllNonBaseMenuItem:function(b){ad("hideAllNonBaseMenuItem",{},b)},showAllNonBaseMenuItem:function(b){ad("showAllNonBaseMenuItem",{},b)},scanQRCode:function(b){b=b||{},ad("scanQRCode",{needResult:b.needResult||0,scanType:b.scanType||["qrCode","barCode"]},function(){return b._complete=function(e){var d,f;H&&(d=e.resultStr,d&&(f=JSON.parse(d),e.resultStr=f&&f.scan_code&&f.scan_code.scan_result))
},b}())},openProductSpecificView:function(b){ad(R.openProductSpecificView,{pid:b.productId,view_type:b.viewType||0,ext_info:b.extInfo},b)},addCard:function(i){var m,l,k,j,c=i.cardList,n=[];for(m=0,l=c.length;l>m;++m){k=c[m],j={card_id:k.cardId,card_ext:k.cardExt},n.push(j)}ad(R.addCard,{card_list:n},function(){return i._complete=function(g){var p,o,h,f=g.card_list;if(f){for(f=JSON.parse(f),p=0,o=f.length;o>p;++p){h=f[p],h.cardId=h.card_id,h.cardExt=h.card_ext,h.isSuccess=h.is_succ?!0:!1,delete h.card_id,delete h.card_ext,delete h.is_succ}g.cardList=f,delete g.card_list}},i}())},chooseCard:function(b){ad("chooseCard",{app_id:D.appId,location_id:b.shopId||"",sign_type:b.signType||"SHA1",card_id:b.cardId||"",card_type:b.cardType||"",card_sign:b.cardSign,time_stamp:b.timestamp+"",nonce_str:b.nonceStr},function(){return b._complete=function(c){c.cardList=c.choose_card_info,delete c.choose_card_info
},b}())},openCard:function(i){var m,l,k,j,c=i.cardList,n=[];for(m=0,l=c.length;l>m;++m){k=c[m],j={card_id:k.cardId,code:k.code},n.push(j)}ad(R.openCard,{card_list:n},i)},chooseWXPay:function(b){ad(R.chooseWXPay,aa(b),b)}},ae&&(af.wx=af.jWeixin=L),L}});