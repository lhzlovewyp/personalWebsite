!function(a,b){"function"==typeof define&&(define.amd||define.cmd)?define("libs_jweixin",function(){return b(a)}):b(a,!0)}(this,function(x,y){function z(D,E,F){x.WeixinJSBridge?WeixinJSBridge.invoke(D,B(E),function(G){a(D,G,F)}):d(D,F)}function A(D,E,F){x.WeixinJSBridge?WeixinJSBridge.on(D,function(G){F&&F.trigger&&F.trigger(G),a(D,G,E)}):F?d(D,F):d(D,E)}function B(D){return D=D||{},D.appId=w.appId,D.verifyAppId=w.appId,D.verifySignType="sha1",D.verifyTimestamp=w.timestamp+"",D.verifyNonceStr=w.nonceStr,D.verifySignature=w.signature,D}function C(I){var G=I.timestamp+"";var F=I.nonceStr;var H=I["package"];var E=I.paySign;var D=I.signType||"SHA1";return{timeStamp:G,nonceStr:F,"package":H,paySign:E,signType:D}}function a(H,I,D){var E,F,G;switch(delete I.err_code,delete I.err_desc,delete I.err_detail,E=I.errMsg,E||(E=I.err_msg,delete I.err_msg,E=b(H,E),I.errMsg=E),D=D||{},D._complete&&(D._complete(I),delete D._complete),E=I.errMsg||"",w.debug&&!D.isInnerInvoke&&alert(JSON.stringify(I)),F=E.indexOf(":"),G=E.substring(F+1)){case"ok":D.success&&D.success(I);
break;case"cancel":D.cancel&&D.cancel(I);break;default:D.fail&&D.fail(I)}D.complete&&D.complete(I)}function b(H,I){var F,G,D=H,E=j[D];return E&&(D=E),F="ok",I&&(G=I.indexOf(":"),F=I.substring(G+1),"confirm"==F&&(F="ok"),"failed"==F&&(F="fail"),-1!=F.indexOf("failed_")&&(F=F.substring(7)),-1!=F.indexOf("fail_")&&(F=F.substring(5)),F=F.replace(/_/g," "),F=F.toLowerCase(),("access denied"==F||"no permission to execute"==F)&&(F="permission denied"),"config"==D&&"function not exist"==F&&(F="ok"),""==F&&(F="fail")),I=D+":"+F}function c(G){var H,D,E,F;if(G){for(H=0,D=G.length;D>H;++H){E=G[H],F=i[E],F&&(G[H]=F)}return G}}function d(E,F){if(!(!w.debug||F&&F.isInnerInvoke)){var D=j[E];D&&(E=D),F&&F._complete&&delete F._complete,console.log('"'+E+'",',F||"")}}function e(){if(!("6.0.2">t||v.systemType<0)){var D=new Image;
v.appId=w.appId,v.initTime=u.initEndTime-u.initStartTime,v.preVerifyTime=u.preVerifyEndTime-u.preVerifyStartTime,o.getNetworkType({isInnerInvoke:!0,success:function(E){v.networkType=E.networkType;var F="https://open.weixin.qq.com/sdk/report?v="+v.version+"&o="+v.isPreVerifyOk+"&s="+v.systemType+"&c="+v.clientVersion+"&a="+v.appId+"&n="+v.networkType+"&i="+v.initTime+"&p="+v.preVerifyTime+"&u="+v.url;D.src=F}})}}function f(){return(new Date).getTime()}function g(D){q&&(x.WeixinJSBridge?D():l.addEventListener&&l.addEventListener("WeixinJSBridgeReady",D,!1))}function h(){o.invoke||(o.invoke=function(D,E,F){x.WeixinJSBridge&&WeixinJSBridge.invoke(D,B(E),F)},o.on=function(D,E){x.WeixinJSBridge&&WeixinJSBridge.on(D,E)})}var i,j,l,n,p,q,r,s,t,u,v,w,k,m,o;if(!x.jWeixin){return i={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},j=function(){var E,D={};
for(E in i){D[i[E]]=E}return D}(),l=x.document,n=l.title,p=navigator.userAgent.toLowerCase(),q=-1!=p.indexOf("micromessenger"),r=-1!=p.indexOf("android"),s=-1!=p.indexOf("iphone")||-1!=p.indexOf("ipad"),t=function(){var D=p.match(/micromessenger\/(\d+\.\d+\.\d+)/)||p.match(/micromessenger\/(\d+\.\d+)/);return D?D[1]:""}(),u={initStartTime:f(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},v={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:s?1:r?2:-1,clientVersion:t,url:encodeURIComponent(location.href)},w={},k={_completes:[]},m={state:0,res:{}},g(function(){u.initEndTime=f()}),o={config:function(D){w=D,d("config",D);var E=w.check===!1?!1:!0;g(function(){var F,G,H;if(E){z(i.config,{verifyJsApiList:c(w.jsApiList)},function(){k._complete=function(J){u.preVerifyEndTime=f(),m.state=1,m.res=J
},k.success=function(){v.isPreVerifyOk=0},k.fail=function(J){k._fail?k._fail(J):m.state=-1};var I=k._completes;return I.push(function(){w.debug||e()}),k.complete=function(){for(var K=0,J=I.length;J>K;++K){I[K]()}k._completes=[]},k}()),u.preVerifyStartTime=f()}else{for(m.state=1,F=k._completes,G=0,H=F.length;H>G;++G){F[G]()}k._completes=[]}}),w.beta&&h()},ready:function(D){0!=m.state?D():(k._completes.push(D),!q&&w.debug&&D())},error:function(D){"6.0.2">t||(-1==m.state?D(m.res):k._fail=D)},checkJsApi:function(D){var E=function(H){var F,G,I=H.checkResult;for(F in I){G=j[F],G&&(I[G]=I[F],delete I[F])}return H};z("checkJsApi",{jsApiList:c(D.jsApiList)},function(){return D._complete=function(F){if(r){var G=F.checkResult;G&&(F.checkResult=JSON.parse(G))}F=E(F)},D}())},onMenuShareTimeline:function(D){A(i.onMenuShareTimeline,{complete:function(){z("shareTimeline",{title:D.title||n,desc:D.title||n,img_url:D.imgUrl||"",link:D.link||location.href,type:D.type||"link",data_url:D.dataUrl||""},D)
}},D)},onMenuShareAppMessage:function(D){A(i.onMenuShareAppMessage,{complete:function(){z("sendAppMessage",{title:D.title||n,desc:D.desc||"",link:D.link||location.href,img_url:D.imgUrl||"",type:D.type||"link",data_url:D.dataUrl||""},D)}},D)},onMenuShareQQ:function(D){A(i.onMenuShareQQ,{complete:function(){z("shareQQ",{title:D.title||n,desc:D.desc||"",img_url:D.imgUrl||"",link:D.link||location.href},D)}},D)},onMenuShareWeibo:function(D){A(i.onMenuShareWeibo,{complete:function(){z("shareWeiboApp",{title:D.title||n,desc:D.desc||"",img_url:D.imgUrl||"",link:D.link||location.href},D)}},D)},onMenuShareQZone:function(D){A(i.onMenuShareQZone,{complete:function(){z("shareQZone",{title:D.title||n,desc:D.desc||"",img_url:D.imgUrl||"",link:D.link||location.href},D)}},D)},startRecord:function(D){z("startRecord",{},D)
},stopRecord:function(D){z("stopRecord",{},D)},onVoiceRecordEnd:function(D){A("onVoiceRecordEnd",D)},playVoice:function(D){z("playVoice",{localId:D.localId},D)},pauseVoice:function(D){z("pauseVoice",{localId:D.localId},D)},stopVoice:function(D){z("stopVoice",{localId:D.localId},D)},onVoicePlayEnd:function(D){A("onVoicePlayEnd",D)},uploadVoice:function(D){z("uploadVoice",{localId:D.localId,isShowProgressTips:0==D.isShowProgressTips?0:1},D)},downloadVoice:function(D){z("downloadVoice",{serverId:D.serverId,isShowProgressTips:0==D.isShowProgressTips?0:1},D)},translateVoice:function(D){z("translateVoice",{localId:D.localId,isShowProgressTips:0==D.isShowProgressTips?0:1},D)},chooseImage:function(D){z("chooseImage",{scene:"1|2",count:D.count||9,sizeType:D.sizeType||["original","compressed"],sourceType:D.sourceType||["album","camera"]},function(){return D._complete=function(E){if(r){var F=E.localIds;
F&&(E.localIds=JSON.parse(F))}},D}())},previewImage:function(D){z(i.previewImage,{current:D.current,urls:D.urls},D)},uploadImage:function(D){z("uploadImage",{localId:D.localId,isShowProgressTips:0==D.isShowProgressTips?0:1},D)},downloadImage:function(D){z("downloadImage",{serverId:D.serverId,isShowProgressTips:0==D.isShowProgressTips?0:1},D)},getNetworkType:function(D){var E=function(I){var F,G,H,J=I.errMsg;if(I.errMsg="getNetworkType:ok",F=I.subtype,delete I.subtype,F){I.networkType=F}else{switch(G=J.indexOf(":"),H=J.substring(G+1)){case"wifi":case"edge":case"wwan":I.networkType=H;break;default:I.errMsg="getNetworkType:fail"}}return I};z("getNetworkType",{},function(){return D._complete=function(F){F=E(F)},D}())},openLocation:function(D){z("openLocation",{latitude:D.latitude,longitude:D.longitude,name:D.name||"",address:D.address||"",scale:D.scale||28,infoUrl:D.infoUrl||""},D)
},getLocation:function(D){D=D||{},z(i.getLocation,{type:D.type||"wgs84"},function(){return D._complete=function(E){delete E.type},D}())},hideOptionMenu:function(D){z("hideOptionMenu",{},D)},showOptionMenu:function(D){z("showOptionMenu",{},D)},closeWindow:function(D){D=D||{},z("closeWindow",{immediate_close:D.immediateClose||0},D)},hideMenuItems:function(D){z("hideMenuItems",{menuList:D.menuList},D)},showMenuItems:function(D){z("showMenuItems",{menuList:D.menuList},D)},hideAllNonBaseMenuItem:function(D){z("hideAllNonBaseMenuItem",{},D)},showAllNonBaseMenuItem:function(D){z("showAllNonBaseMenuItem",{},D)},scanQRCode:function(D){D=D||{},z("scanQRCode",{needResult:D.needResult||0,scanType:D.scanType||["qrCode","barCode"]},function(){return D._complete=function(F){var G,E;s&&(G=F.resultStr,G&&(E=JSON.parse(G),F.resultStr=E&&E.scan_code&&E.scan_code.scan_result))
},D}())},openProductSpecificView:function(D){z(i.openProductSpecificView,{pid:D.productId,view_type:D.viewType||0,ext_info:D.extInfo},D)},addCard:function(H){var D,E,F,G,J=H.cardList,I=[];for(D=0,E=J.length;E>D;++D){F=J[D],G={card_id:F.cardId,card_ext:F.cardExt},I.push(G)}z(i.addCard,{card_list:I},function(){return H._complete=function(L){var N,O,K,M=L.card_list;if(M){for(M=JSON.parse(M),N=0,O=M.length;O>N;++N){K=M[N],K.cardId=K.card_id,K.cardExt=K.card_ext,K.isSuccess=K.is_succ?!0:!1,delete K.card_id,delete K.card_ext,delete K.is_succ}L.cardList=M,delete L.card_list}},H}())},chooseCard:function(D){z("chooseCard",{app_id:w.appId,location_id:D.shopId||"",sign_type:D.signType||"SHA1",card_id:D.cardId||"",card_type:D.cardType||"",card_sign:D.cardSign,time_stamp:D.timestamp+"",nonce_str:D.nonceStr},function(){return D._complete=function(E){E.cardList=E.choose_card_info,delete E.choose_card_info
},D}())},openCard:function(H){var D,E,F,G,J=H.cardList,I=[];for(D=0,E=J.length;E>D;++D){F=J[D],G={card_id:F.cardId,code:F.code},I.push(G)}z(i.openCard,{card_list:I},H)},chooseWXPay:function(D){z(i.chooseWXPay,C(D),D)}},y&&(x.wx=x.jWeixin=o),o}});