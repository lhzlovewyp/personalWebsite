define(["common_touch"],function(c){var d={init:function(b){for(var a in b){this[a]=b[a]}var f=this;this.lastMoved=null;if(!this.outer||!this.inner){return false}this.setStyle();c({element:f.outer,start:function(e){f.start(e)},move:function(l,n,m,o,p,e){f.move(l,n,m,o,p,e)},end:function(){f.end()},sliceEnd:function(e){f.sliceEnd(e)}})},setStyle:function(){var b=this.outer,a=this.prefix;this._setY(this.inner,0)},start:function(a){if(!!this.moving){return false}this.touchstartY=this._getY(this.inner);this.movedDis=0;this._transiton(false)},move:function(b,k,e,l,m,a){if(k==="lr"||k==="rl"){this.touchstartY=null;return}if(!!this.moving){return false}if(this.touchstartY==null){this.start();this.movedDis=l;return}var n=l-this.movedDis+this.touchstartY;if(n>=0){n=0}this.move2Pos(n)},end:function(){this.movedDis=0;
this.touchstartY=null},sliceEnd:function(b){if(!!this.moving){return false}var q=this.outer.clientHeight,o=this.inner.clientHeight;var a=this;var p=b.y;var l=Math.abs(b.y);var m=this._getY(this.inner);var n=m;if(l>0.5){var r=(l/b.y)*200;n=m+r}else{n=m}if(!n){return false}if(n>=0){n=0;this.atTop&&this.atTop.apply(null)}if(Math.abs(n)+q>=o){n=-(o-q);this.atEnd&&this.atEnd.apply(null)}this._transiton(true);this.move2Pos(n)},move2Pos:function(b,a){this._setY(this.inner,b);if(a){return}this.onMove&&this.onMove.apply(this,[b])},scroll2Pos:function(h,a){a=a||500;var b=this;var g=this._getY(this.inner);this._transiton(true);this.move2Pos(h)},_setX:function(b,a){if(!b){return false}b.style.webkitTransform="translateX("+a+"px)"},_getX:function(a){if(!a){return false}return parseFloat(a.style.webkitTransform.replace("translateX(",""))
},_setY:function(b,a){if(!b){return false}a=~~a;b.style.webkitTransform="translate3d(0px,"+a+"px,0px)"},_getY:function(a){if(!a){return false}var b;a.style.webkitTransform.replace(/[\w(\.\s]*,{1}\s*(-?\d+\.?\d*)\s*[\w,\.]*/,function(h,g){b=~~g});return b},_transiton:function(a){if(a){this.inner.style.webkitTransition="-webkit-transform 0.4s"}else{this.inner.style.webkitTransition=""}}};return d});