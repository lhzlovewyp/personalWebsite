define([pathurl+"/mglobal/js/biz/yhd.productInfo.js",pathurl+"/mglobal/js/lib/template/ejs"],function(e,f){var d=function(a){var b=a,c={lazyLoadDelay:500,load:true,oneOffLoad:false,scrollLoad:true,productType:"general",callbackHtml:null,parentId:"",productIds:""};$.extend(c,b);this.param=c};d.prototype={constructor:d,isBusy:false,doc:document,priceArray:[],lazyPrice:function(c,i){var a=this,j=a.param;if(i){a.param=$.extend(j,i)}var b=c;if(j.oneOffLoad){a._lazyPrice(j);return c}if(j.load){a._lazyPrice(j)}if(j.scrollLoad){a._iniLazy(function(){a._lazyPrice(j)})}},_loadPrice:function(){var a=this,c=a.param,b=c.lazyLoadDelay;(function(j,k){var l=setInterval(function(){if(j.isBusy){return false}j._priceLoad()},k)})(a,b)},_lazyPrice:function(b,a){_this=this;_this.isBusy=true;_this._priceLoad()},_priceLoad:function(){var a={};
a.productType=this.param.productType;a.ids=this.param.productIds;e.getProductInfo(a,function(b){var c=new f({url:template}).render(b);$("#"+parentId).html(c);this.isBusy=false})},_iniLazy:function(b){var a=this;$(window).bind("scroll",function(){if(!a.isBusy){b()}else{}})}}});