define("common_back",["tracker_ref_yhd.global_spm","common_yhd.storage"],function(z,D){var F={};var L=window.loli||(window.loli={});var w=L.app=L.app||{};var B=L.app.url=L.app.url||{};var H=L.yhdSessionStore;var x=L.app.url.cfg=L.app.url.cfg||{enable:true,type:"url",maxSize:100};var J=function(){var a="user_browse_history";if(window.name==""){window.name=new Date().getTime()}return a+"_"+window.name};var G=J();var K=function(a){H.getFromRoot(G,function(b){var d=null;if(b&&b.status==1){var c=b.value;d=(c!=null&&c!="")?$.parseJSON(c):null}a(d)})};var A=function(b,c){var a=b?JSON.stringify(b):"";H.setFromRoot(G,a,function(d){if(c){c(d)}})};var u=function(c){var f="";var a="";var h="";var e="";var b=/^(http[s]?:\/\/[\.\w]*\.yhd\.com)[\/]?/i;var g=/^http[s]?:\/\/[\.\w]*\.yhd\.com(\/[^\?]*\/?)[\?\#]*/i;
var d=/(\?[^\#]*)/i;var i=/(\#.*)/i;if(b.test(c)){f=b.exec(c)[1]}if(g.test(c)){a=g.exec(c)[1]}if(d.test(c)){h=d.exec(c)[1]}if(i.test(c)){e=i.exec(c)[1]}return{domain:f,path:a,params:h,hash:e}};var v=function(e,d){var a=new RegExp("[?&]"+d+"=[^&#]*");var b=e;if(a.test(e)){var c=a.exec(e)[0];if(c.charAt(0)=="?"){b=e.replace(a,"?")}else{b=e.replace(a,"")}if(b.indexOf("?&")!=-1){b=b.substring(0,b.indexOf("?&")+1)+b.substring(b.indexOf("?&")+2)}if(b.charAt(b.length-1)=="?"){b=b.substring(0,b.length-1)}}return b};var I=function(a){var b=/(\#.*)/i;var c=a;if(b.test(a)){c=a.replace(b,"")}return c};var y=function(a){var b=v(a,"tp");b=v(b,"tc");b=v(b,"tce");return b};var t=function(l,h){var e=window.user_browse_history;var k=y(document.location.href);var f=-1;if(e&&e.data&&e.data.length>0){if(l=="url"){if(h){for(var c=e.index-1;
c>=0;c--){var j=I(y(e.data[c]));if(j&&h==j){f=c-e.index;break}}}else{var a=I(y(k));var b=false;for(var c=e.index-1;c>=0;c--){var j=I(y(e.data[c]));if(j&&a!=j){f=c-e.index;b=true;break}}if(!b){if(window.history.length>e.data.length){f=0-(e.index+1)}}}}else{if(l=="path"){if(h){for(var c=e.index-1;c>=0;c--){var j=y(e.data[c]);if(j){var d=u(j);if(d.path==h){f=c-e.index;break}}}}else{var i=u(k).path;var b=false;for(var c=e.index-1;c>=0;c--){var j=y(e.data[c]);if(j){var d=u(j);if(d.path!=i){f=c-e.index;b=true;break}}}if(!b){if(window.history.length>e.data.length){f=0-(e.index+1)}}}}else{if(l=="domain"){if(h){for(var c=e.index-1;c>=0;c--){var j=y(e.data[c]);if(j){var d=u(j);if(d.domain==h){f=c-e.index;break}}}}else{var g=u(k).domain;var b=false;for(var c=e.index-1;c>=0;c--){var j=y(e.data[c]);if(j){var d=u(j);
if(d.domain!=g){f=c-e.index;b=true;break}}}if(!b){if(window.history.length>e.data.length){f=0-(e.index+1)}}}}else{if(h){for(var c=e.index-1;c>=0;c--){var j=y(e.data[c]);if(j&&h==j){f=c-e.index;break}}}else{f=-1}}}}}return f};var E=function(d,c){var f=window.user_browse_history!=null?window.user_browse_history:{data:[],index:-1,timestamp:0};var b=document.location.href;if(!d){return}if(d==1){if(f.data&&f.data.length>0){var a=f.data[f.index];if(a==b){return}}if(f.data&&f.data.length>0&&f.index>-1){if(f.data.length-1>=f.index+1){f.data.splice(f.index+1)}}f.data.push(b);f.index=f.index+1}else{if(d==2){f={data:[],index:-1};f.data.push(b);f.index=f.index+1}else{if(d==3){if(f.index!=-1){f.index=f.index-1}}else{if(d==4){if(f.index!=-1){f.index=f.index+1}}else{if(d==5){if(c!=-1){f.index=c}}}}}}var e=f.data.length-x.maxSize;
if(e>0&&f.index>=e){f.data.splice(0,e);f.index=f.index-e}f.timestamp=new Date().getTime();f.historyLength=window.history.length;A(f,function(){window.user_browse_history=f})};var C=function(b){var h=document.location.href;var f=0;var e=-1;if(b&&b.data&&b.data.length>0&&b.index>-1){var g=b.data[b.index-1];var a=b.data[b.index+1];if(h==g){f=3}else{if(h==a){f=4}else{f=5;for(var c=b.index-1;c>=0;c--){var d=b.data[c];if(d==h){e=c;break}}if(e==-1){for(var c=b.index;c<b.data.length;c++){var d=b.data[c];if(d==h){e=c;break}}}if(e==-1){f=2}}}}else{f=2}return{flag:f,curIndex:e}};B.saveURL=function(){var a=document.referrer;var b=document.location.href;if(window.user_browse_history){return}K(function(e){window.user_browse_history=e;var f=0;var d=-1;if(!e||!e.data||e.data.length==0){f=2;E(f);return}var g=window.performance.navigation.type;
if(g==0){if(e&&e.data&&e.data.length>0){var h=e.data[e.index];if(a==""){if(window.history.length-1>e.historyLength){f=2}else{f=1}}else{if(a==h||a==I(h)){f=1}else{f=2}}}else{f=2}}else{if(g==1){f=0;if(e&&e.data&&e.data.length>0){var h=e.data[e.index];if(h!=b){f=2}}else{f=2}}else{if(g==2){var c=C(e);f=c.flag;d=c.curIndex}else{f=1}}}if(f){E(f,d)}})};B.saveAnchor=function(){var b=window.history.length;var a=window.history.state;window.onpopstate=function(d){var c=d||window.event;var i=document.location.href;var f=0;var h=-1;var g=function(l){if(!l||!l.data||l.data.length==0){f=2;E(f);return}if(l.data&&l.data.length>0){var n=l.data[l.index];if(n==i){return}}if(l&&l.data&&l.data.length>0&&l.index>-1){var n=l.data[l.index];if(I(i)!=I(n)){var k=C(l);f=k.flag;h=k.curIndex;E(f,h);return}}if(b==window.history.length){var m=window.history.state;
if(m==null&&a!=null){f=3}else{if(m!=null&&a!=null){if(m.timestamp<=a.timestamp){f=3}else{f=4}}else{if(m!=null&&a==null){f=4}else{f=0}}}}else{var j=new Date().getTime();window.history.replaceState({timestamp:j},"",document.location.hash);f=1}b=window.history.length;a=window.history.state;if(f){E(f,h)}};var e=window.user_browse_history;if(e){g(e)}else{K(g)}}};B.goBack=function(b,c){var d=b?b:x.type;var a=t(d,c);window.history.go(a)};B.isHTML5=function(){if(window.performance&&window.history.replaceState&&window.sessionStorage&&window.postMessage){return true}return false};F.saveURL=function(){if(L.app.url.isHTML5()){L.app.url.saveURL();L.app.url.saveAnchor()}};F.init=function(a){if(a){x=$.extend(x,a)}if(!x.enable){return}if(L.app.url.isHTML5()){$("#topIconBack").attr("href","javascript:void(0);");
$("#topIconBack").off().on("click",function(){L.app.url.goBack()})}};return F});