(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(m,g){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(m).attr("autocomplete","off").addClass(g.inputClass);
var j;var r="";var o=a.Autocompleter.Cache(g);var e=0;var w;var x={mouseDownOnSelect:false};var t=a.Autocompleter.Select(g,m,d,x);var n;a.browser.opera&&a(m.form).bind("submit.autocomplete",function(){if(n){n=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(y){e=1;w=y.keyCode;switch(y.keyCode){case c.UP:y.preventDefault();if(t.visible()){t.prev()}else{v(0,true)}break;case c.DOWN:y.preventDefault();if(t.visible()){t.next()}else{v(0,true)}break;case c.PAGEUP:y.preventDefault();if(t.visible()){t.pageUp()}else{v(0,true)}break;case c.PAGEDOWN:y.preventDefault();if(t.visible()){t.pageDown()}else{v(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){y.preventDefault();n=true;return false}break;case c.ESC:t.hide();
break;default:clearTimeout(j);j=setTimeout(v,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!x.mouseDownOnSelect){u()}}).click(function(){if(e++>1&&!t.visible()){v(0,true)}}).bind("search",function(){var y=(arguments.length>1)?arguments[1]:null;function z(C,B){var D;if(B&&B.length){for(var A=0;A<B.length;A++){if(B[A].result.toLowerCase()==C.toLowerCase()){D=B[A];break}}}if(typeof y=="function"){y(D)}else{b.trigger("result",D&&[D.data,D.value])}}a.each(h(b.val()),function(B,A){f(A,z,z)})}).bind("flushCache",function(){o.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){o.populate()}}).bind("unautocomplete",function(){t.unbind();b.unbind();a(m.form).unbind(".autocomplete")});function d(){var y=t.selected();if(!y){return false}var z=y.result;
r=z;if(g.multiple){var D=h(b.val());if(D.length>1){var E=g.multipleSeparator.length;var C=a(m).selection().start;var A,B=0;a.each(D,function(F,G){B+=G.length;if(C<=B){A=F;return false}B+=E});D[A]=z;z=D.join(g.multipleSeparator)}z+=g.multipleSeparator}b.val(z);l();b.trigger("result",[y.data,y.value]);return true}function v(A,z){if(w==c.DEL){t.hide();return}var y=b.val();if(!z&&y==r){return}r=y;y=i(y);if(y.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){y=y.toLowerCase()}f(y,k,l)}else{p();t.hide()}}function h(y){if(!y){return[""]}if(!g.multiple){return[a.trim(y)]}return a.map(y.split(g.multipleSeparator),function(z){return a.trim(y).length?a.trim(z):null})}function i(y){if(!g.multiple){return y}var A=h(y);if(A.length==1){return A[0]}var z=a(m).selection().start;if(z==y.length){A=h(y)
}else{A=h(y.replace(y.substring(z),""))}return A[A.length-1]}function s(y,z){if(g.autoFill&&(i(b.val()).toLowerCase()==y.toLowerCase())&&w!=c.BACKSPACE){b.val(b.val()+z.substring(i(r).length));a(m).selection(r.length,r.length+z.length)}}function u(){clearTimeout(j);j=setTimeout(l,200)}function l(){var y=t.visible();t.hide();clearTimeout(j);p();if(g.mustMatch){b.search(function(z){if(!z){if(g.multiple){var A=h(b.val()).slice(0,-1);b.val(A.join(g.multipleSeparator)+(A.length?g.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function k(z,y){if(y&&y.length&&e){p();t.display(y,z);s(z,y[0].value);t.show()}else{l()}}function f(A,y,z){if(!g.matchCase){A=A.toLowerCase()}var C=o.load(A);if(C&&C.length){y(A,C)}else{if((typeof g.url=="string")&&(g.url.length>0)){var B={timestamp:+new Date()};
a.each(g.extraParams,function(D,E){B[D]=typeof E=="function"?E():E});a.ajax({mode:"abort",port:"autocomplete"+m.name,dataType:g.dataType,url:g.url,data:a.extend({q:i(A),limit:g.max},B),success:function(E){var D=g.parse&&g.parse(E)||q(E);o.add(A,D);y(A,D)}})}else{t.emptyList();z(A)}}}function q(y){var z=[];var C=y.split("\n");for(var A=0;A<C.length;A++){var B=a.trim(C[A]);if(B){B=B.split("|");z[z.length]={data:B,value:B[0],result:g.formatResult&&g.formatResult(B,B[0])||B[0]}}}return z}function p(){b.removeClass(g.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]
},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(h){var e={};var b=0;function g(k,j){if(!h.matchCase){k=k.toLowerCase()}var i=k.indexOf(j);var l=/^[a-zA-Z]{1,}$/;if(h.matchContains=="word"&&l.test(j)){i=k.toLowerCase().search("\\b"+j.toLowerCase())}if(i==-1){return false}return i==0||h.matchContains}function f(j,i){if(b>h.cacheLength){c()}if(!e[j]){b++}e[j]=i}function d(){if(!h.data){return false}var n={},m=0;if(!h.url){h.cacheLength=1}n[""]=[];for(var p=0,o=h.data.length;p<o;p++){var j=h.data[p];j=(typeof j=="string")?[j]:j;
var l=h.formatMatch(j,p+1,h.data.length);if(l===false){continue}var i=l.charAt(0).toLowerCase();if(!n[i]){n[i]=[]}var k={value:l,data:j,result:h.formatResult&&h.formatResult(j)||l};n[i].push(k);if(m++<h.max){n[""].push(k)}}a.each(n,function(q,r){h.cacheLength++;f(q,r)})}setTimeout(d,25);function c(){e={};b=0}return{flush:c,add:f,populate:d,load:function(i){i=jQuery.trim(i);if(!h.cacheLength||!b){return null}if(!h.url&&h.matchContains&&i!=""){var m=[];for(var k in e){if(k.length>0){var j=e[k];a.each(j,function(p,n){if(g(n.value,i)){m.push(n)}})}}return m}else{if(e[i]){return e[i]}else{if(h.matchSubset){for(var l=i.length-1;l>=h.minChars;l--){var j=e[i.substr(0,l)];if(j){var m=[];a.each(j,function(p,n){if(g(n.value,i)){m[m.length]=n}});return m}}}}}return null}}};a.Autocompleter.Select=function(i,q,b,j){var p={ACTIVE:"ac_over"};
var r,k=-1,n,d="",s=true,e,h;function f(){if(!s){return}e=a("<div/>").hide().addClass(i.resultsClass).css("position","absolute").appendTo(document.body);h=a("<ul/>").appendTo(e).mouseover(function(t){if(l(t).nodeName&&l(t).nodeName.toUpperCase()=="LI"){k=a("li",h).removeClass(p.ACTIVE).index(l(t));a(l(t)).addClass(p.ACTIVE)}}).click(function(t){a(l(t)).addClass(p.ACTIVE);b();q.focus();return false}).mousedown(function(){j.mouseDownOnSelect=true}).mouseup(function(){j.mouseDownOnSelect=false});if(i.width>0){e.css("width",i.width)}s=false}function l(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function o(t){r.slice(k,k+1).removeClass(p.ACTIVE);m(t);var v=r.slice(k,k+1).addClass(p.ACTIVE);if(i.scroll){var u=0;r.slice(0,k).each(function(){u+=this.offsetHeight
});if((u+v[0].offsetHeight-h.scrollTop())>h[0].clientHeight){h.scrollTop(u+v[0].offsetHeight-h.innerHeight())}else{if(u<h.scrollTop()){h.scrollTop(u)}}}}function m(t){k+=t;if(k<0){k=r.size()-1}else{if(k>=r.size()){k=0}}}function c(t){return i.max&&i.max<t?i.max:t}function g(){h.empty();var t=0;var v=c(n.length);for(var w=0;w<v;w++){if(!n[w]){continue}var x=i.formatItem(n[w].data,w+1,v,n[w].value,d);if(n[w].data.value=="0"){t=1}if(x===false){continue}var u=a("<li/>").html(i.highlight(x,d)).addClass(w%2==0?"ac_even":"ac_odd").appendTo(h)[0];a.data(u,"ac_data",n[w])}r=h.find("li");if(i.selectFirst){if(t==1){r.slice(1,2).addClass(p.ACTIVE)}else{r.slice(0,1).addClass(p.ACTIVE)}k=0}if(a.fn.bgiframe){h.bgiframe()}}return{display:function(u,t){f();n=u;d=t;g()},next:function(){o(1)},prev:function(){o(-1)
},pageUp:function(){if(k!=0&&k-8<0){o(-k)}else{o(-8)}},pageDown:function(){if(k!=r.size()-1&&k+8>r.size()){o(r.size()-1-k)}else{o(8)}},hide:function(){e&&e.hide();r&&r.removeClass(p.ACTIVE);k=-1},visible:function(){return e&&e.is(":visible")},current:function(){return this.visible()&&(r.filter("."+p.ACTIVE)[0]||i.selectFirst&&r[0])},show:function(){var v=a(q).offset();e.css({width:typeof i.width=="string"||i.width>0?i.width:a(q).width(),top:v.top+q.offsetHeight,left:v.left}).show();if(i.scroll){h.scrollTop(0);h.css({maxHeight:i.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;r.each(function(){t+=this.offsetHeight});var u=t>i.scrollHeight;h.css("height",u?i.scrollHeight:t);if(!u){r.width(h.width()-parseInt(r.css("padding-left"))-parseInt(r.css("padding-right")))
}}}},selected:function(){var t=r&&r.filter("."+p.ACTIVE).removeClass(p.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){h&&h.empty()},unbind:function(){e&&e.remove()}}};a.fn.selection=function(f,d){if(f!==undefined){return this.each(function(){if(this.createTextRange){var j=this.createTextRange();if(d===undefined||f==d){j.move("character",f);j.select()}else{j.collapse(true);j.moveStart("character",f);j.moveEnd("character",d);j.select()}}else{if(this.setSelectionRange){this.setSelectionRange(f,d)}else{if(this.selectionStart){this.selectionStart=f;this.selectionEnd=d}}}})}var c=this[0];if(c.createTextRange){var g=document.selection.createRange(),e=c.value,b="<->",h=g.text.length;g.text=b;var i=c.value.indexOf(b);c.value=e;this.selection(i,i+h);return{start:i,end:i+h}}else{if(c.selectionStart!==undefined){return{start:c.selectionStart,end:c.selectionEnd}
}}}})(jQuery);