(function(aC){var al=window.loli||(window.loli={});var au=al.app=al.app||{};var aG=al.app.minicart=al.app.minicart||{};aG.addItemCallback=function(a,b){};aG.addItemFailback=function(a,b){};aG.removeItemCallback=function(a,b){};aG.removeItemFailback=function(a,b){};aG.updateItemCallback=function(a,b){};aG.updateItemFailback=function(a,b){};aG.chooseItemCallback=function(a,b){};aG.chooseItemFailback=function(a,b){};aG.errorCallback=function(a,b,c){};aG.getJSON=function(a,c,d,b,e){if(e==null){e=3000}jQuery.ajax({url:a,data:c,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonp"+new Date().getTime(),cache:false,timeout:e,success:function(f){if(d){d(f)}},error:function(h,g,f){if(b){b(h,g,f)}else{aG.errorCallback(h,g,f)}}})};var af=aC.cookie("provinceId")||1;var aE=aC.cookie("yihaodian_uid");var aB=URLPrefix.cartDomain||"http://cart.yhd.com";
var W=aC("#miniCart");var aw=aC("#showMiniCartDetail");var ac=aC("#in_cart_num");var aI=function(){var c=window.navigator.userAgent.toLowerCase();var b=/msie ([\d\.]+)/;if(b.test(c)){var a=parseInt(b.exec(c)[1]);return a}return 0};var at=function(d,e,a){var b=e||60;var f=a||60;var c=/_\d+x\d+\.([a-zA-Z]+)$/;if(d){if(c.test(d)){d=d.replace(c,"_"+b+"x"+f+".$1")}else{d=d.substring(0,d.lastIndexOf("."))+"_"+b+"x"+f+d.substring(d.lastIndexOf("."))}}else{d="http://image.yihaodianimg.com/front-homepage/global/images/defaultproduct_"+b+"x"+f+".jpg"}return d};var aA=function(a,c,d,b){aC(a).data("lastTime",new Date().getTime());if(c){var f=c.call(aC(a));aC(a).data("lastResult",f)}var e=setTimeout(function(){var g=aC(a).data("lastTime")?aC(a).data("lastTime"):new Date().getTime();var i=(typeof aC(a).data("lastResult")=="undefined"||aC(a).data("lastResult"))?true:false;
var h=new Date().getTime();if(h-g>=(b-50)){if(d&&i){d.call(aC(a))}}},b)};var ag=[{key:"华北",value:[{id:2,name:"北京"},{id:3,name:"天津"},{id:4,name:"河北"},{id:32,name:"山西"},{id:8,name:"内蒙古"}]},{key:"华东",value:[{id:1,name:"上海"},{id:5,name:"江苏"},{id:6,name:"浙江"},{id:13,name:"安徽"},{id:14,name:"福建"},{id:16,name:"山东"}]},{key:"华南",value:[{id:20,name:"广东"},{id:21,name:"广西"},{id:22,name:"海南"}]},{key:"华中",value:[{id:15,name:"江西"},{id:17,name:"河南"},{id:18,name:"湖北"},{id:19,name:"湖南"}]},{key:"西南",value:[{id:7,name:"重庆"},{id:12,name:"四川"},{id:23,name:"贵州"},{id:24,name:"云南"},{id:25,name:"西藏"}]},{key:"西北",value:[{id:26,name:"陕西"},{id:27,name:"甘肃"},{id:28,name:"青海"},{id:30,name:"宁夏"},{id:29,name:"新疆"}]},{key:"东北",value:[{id:9,name:"辽宁"},{id:10,name:"吉林"},{id:11,name:"黑龙江"}]}];var X=function(){var a=jQuery.cookie("cart_num");
var b=(a&&!isNaN(a))?parseInt(a):0;if(b>0){ac.text(b>999?"999+":b);ac.show()}else{ac.hide()}};var aM=function(){var a=aC.cookie("detail_yhdareas");var f=[];var g=[];var b=/([\d]+_[\d]+_[\d]+)_([\S^_]+_[\S^_]+_[\S^_]+)/;if(a&&b.test(a)){f=b.exec(a)[1].split("_");g=b.exec(a)[2].replace(/\<i\>\<\/i\>/g,"").split("_")}else{f=[af];for(var c=0;c<ag.length;c++){var e=ag[c].value;for(var d=0;d<e.length;d++){if(e[d].id==af){g=[e[d].name];break}}}}return[f,g]};var ab=function(d){if(!d||d.length!=2){return}var a=d[0];var b=d[1];var c=a[0]+"_"+a[1]+"_"+a[2]+"_"+b[0]+"_"+b[1]+"_"+b[2];aC.cookie("provinceId",a[0],{domain:no3wUrl,path:"/",expires:800});aC.cookie("detail_yhdareas",c,{domain:no3wUrl,path:"/",expires:400})};var ay=function(){var b=[];var a=aM();var f=a[0];var g=a[1];b.push("<div class='yhd_province clearfix'>");
b.push("<div class='yhd_area_select'>");b.push("<div class='yhd_address'>");b.push("<span class='hd_val_text' data-value='"+f.join("_")+"'>"+g.join("|")+"</span>");b.push("<i></i>");b.push("</div>");b.push("<div class='yhd_tab_detail none'>");b.push("<div class='yhd_area_tab clearfix'>");b.push("<span data-value='"+f[0]+"' class='yhd_on'><em>"+g[0]+"</em></span>");b.push("<span data-value='"+(f.length>1?f[1]:"")+"' class=''><em>"+(g.length>1?g[1]:"请选择市")+"</em></span>");b.push("<span data-value='"+(f.length>2?f[2]:"")+"' class=''><em>"+(g.length>2?g[2]:"请选择区")+"</em></span>");b.push("</div>");b.push("<div class='yhd_area_box'>");b.push("<div class='yhd_item hd_first_area'>");for(var c=0;c<ag.length;c++){var e=ag[c].value;b.push("<dl class='clearfix'>");b.push("<dt>"+ag[c].key+"：</dt>");for(var d=0;
d<e.length;d++){b.push("<dd><a data-value='"+e[d].id+"' class='"+(f[0]==e[d].id?"hd_cart_cur":"")+"' href='javascript:;'>"+e[d].name+"</a></dd>")}b.push("</dl>")}b.push("</div>");b.push("<div class='yhd_item yhd_second_area none'>");b.push("</div>");b.push("<div class='yhd_item yhd_third_area none' data-tpc='1'>");b.push("</div>");b.push("</div>");b.push("<span class='yhd_close_btn'>×</span>");b.push("</div>");b.push("</div>");b.push("</div>");return b.join("")};var ak=function(c,j,m){var i=[];var e=at(c.pic);var g="http://item.yhd.com/item/"+c.pmId;var b=c.name;var l=c.checked;var k=c.amount!=null?c.amount.money:0;var a=c.amount!=null?c.amount.points:0;var d="";var h="";if(a>0){d+=a+"积分"}if(k>0){d+="+¥"+k}if(d.indexOf("+")==0){d=d.substring(1)}if(d==""){d="¥0"}if(j){l=false;h="商品无库存或当前区域不销售"
}if(c.typeValue==3){m=false;e=URLPrefix.statics+"/global/images/promotion_mix.jpg";g=URLPrefix.search+"/p/pt"+c.promotion.promotionId+"-pl"+c.promotion.promotionLevelId;b=c.promotion.title}if(c.typeValue==9){var f=c.promotion.promotionId;g="http://item.yhd.com/item/lp/"+f+"_"+c.pmId+"_"+af}i.push("<div class='clearfix hd_cart_wrap'>");i.push("<a data-tpc='4' class='hd_select_box "+(l?"hd_selected":"")+"' href='javascript:;' cartItemId='"+c.id+"'></a>");i.push("<a class='hd_pro_img' data-tpc='5' href='"+g+"' target='_blank'><img src='"+e+"' alt=''/></a>");i.push("<div class='hd_cart_detail'>");i.push("<a class='hd_pro_name' data-tpc='6' href='"+g+"' target='_blank' title='"+b+"'>"+b+"</a>");i.push("<p class='hd_subcode'></p>");i.push("<div class='clearfix'>");i.push("<em>"+c.num+"</em>");i.push("<span class='hd_sold_tips'>"+h+"</span>");
if(m){i.push("<div class='hd_num_box'>");i.push("<a data-tpc='8' class='"+(c.num>1?"hd_minus":"hd_minus_disable")+"' href='javascript:;'></a>");i.push("<input type='text' name='itemNum' class='hd_minicart_num' value='"+c.num+"' cartItemId='"+c.id+"'>");i.push("<a class='hd_plus' data-tpc='9' href='javascript:;'></a>");i.push("</div>")}i.push("<b>"+d+"</b>");i.push("</div>");i.push("</div>");i.push("<a class='hd_cart_del' data-tpc='7' href='javascript:;' cartItemId='"+c.id+"'></a>");i.push("<div class='hd_over_tips' style='display: none;'>");i.push("<i></i><p></p>");i.push("</div>");i.push("</div>");return i.join("")};var aL=function(m){var d=[];if(!m||!m.summary){return""}for(var E=0;E<m.bags.length;E++){var A=m.bags[E];var C=A.summary.count;var G=A.yhdMerchant==true?"1号店":A.merchantName;var s=A.yhdMerchant==true?"javascript:;":"http://shop.yhd.com/merchantfront/accessAction.action?merchantId="+A.merchantIds[0]+"&siteId=1";
var a=true;for(var r=0;r<A.itemGroups.length;r++){for(var y=0;y<A.itemGroups[r].items.length;y++){if(!A.itemGroups[r].items[y].checked){a=false;break}}}if(A.itemGroups.length==0){a=false}d.push("<dl>");d.push("<dt>");d.push("<span class='fr'>共<i>"+C+"</i>件商品</span>");d.push("<em class='hd_red_icon'></em>");d.push("<a data-tpc='3' class='hd_select_box "+(a?"hd_selected":"")+"' href='javascript:;'></a>");d.push("<a href='"+s+"' "+(A.yhdMerchant?"":"target='_blank'")+"><b>"+G+"</b></a>");d.push("</dt>");for(var r=0;r<A.itemGroups.length;r++){var c=A.itemGroups[r];for(var y=0;y<c.items.length;y++){var p=c.items[y];var u=(p.typeValue==12||p.typeValue==11)?false:true;var f=false;if(p.typeValue==3){u=false}if(p.typeValue!=2){d.push("<dd class='hd_cart_cur "+(u?"hd_num_cur":"")+"' disable='"+f+"' editable='"+u+"' productId='"+p.productId+"' pmId='"+p.pmId+"' cartItemId='"+p.id+"' parentCartItemId='"+p.id+"' itemNum='"+p.num+"' itemType='"+p.typeValue+"' productType='"+p.productType+"' checkoutType='"+(p.checkoutType?p.checkoutType:0)+"' promotionId='"+(p.promotion?p.promotion.promotionId:"")+"' checked='"+p.checked+"'>");
d.push(ak(p,f,u));for(var t=0;t<p.nestedItems.length;t++){var q=p.nestedItems[t];var k="http://item.yhd.com/item/"+q.pmId;var h="¥"+(q.amount!=null?q.amount.money:0);var H=q.name;if(q.typeValue==10){d.push("<p class='hd_gift'>");d.push("<span class='fr'>"+h+"</span>");d.push("<em class='hd_extend'>延保</em>");d.push("<a href='"+k+"' target='_blank' title='"+H+"'>"+H+"</a>");d.push("<a href='javascript:void(0);' class='hd_gift_del' cartItemId='"+q.id+"'></a>");d.push("</p>")}else{if(q.typeValue==11){d.push("<p class='hd_gift'>");d.push("<span class='fr'>"+h+"</span>");d.push("<em>搭售</em>");d.push("<a href='"+k+"' target='_blank' title='"+H+"'>"+H+"</a>");d.push("<a href='javascript:void(0);' class='hd_gift_del' cartItemId='"+q.id+"'></a>");d.push("</p>")}}}}else{for(var t=0;t<p.nestedItems.length;
t++){var q=p.nestedItems[t];d.push("<dd class='hd_cart_cur "+(u?"hd_num_cur":"")+"' disable='"+f+"' editable='"+u+"' productId='"+q.productId+"' pmId='"+q.pmId+"' cartItemId='"+q.id+"' parentCartItemId='"+p.id+"' itemNum='"+q.num+"' itemType='"+p.typeValue+"' productType='"+p.productType+"' checkoutType='"+(p.checkoutType?p.checkoutType:0)+"' promotionId='"+(p.promotion?p.promotion.promotionId:"")+"' checked='"+q.checked+"'>");d.push(ak(q,f,u));if(t!=p.nestedItems.length-1){d.push("</dd>")}}}if(y==c.items.length-1){for(var j=0;j<c.gifts.length;j++){var i=c.gifts[j];var k="http://item.yhd.com/item/"+i.pmId;var h="¥"+i.price.money;var H=i.name;var b=i.typeValue==14?"换购":"赠品";d.push("<p class='hd_gift'>");if(i.typeValue==14){d.push("<span class='fr'>"+h+"</span>")}d.push("<em>"+b+"</em>");d.push("<a href='"+k+"' target='_blank' title='"+H+"'>"+H+"</a>");
d.push("<a href='javascript:void(0);' class='hd_gift_del' cartItemId='"+i.id+"'></a>");d.push("</p>")}}if(r==A.itemGroups.length-1&&y==c.items.length-1){for(var n=0;n<A.gifts.length;n++){var i=A.gifts[n];var k="http://item.yhd.com/item/"+i.pmId;var h="¥"+i.price.money;var H=i.name;d.push("<p class='hd_gift'>");d.push("<em>赠品</em>");d.push("<a href='"+k+"' target='_blank' title='"+H+"'>"+H+"</a>");d.push("<a href='javascript:void(0);' class='hd_gift_del' cartItemId='"+i.id+"'></a>");d.push("</p>")}for(var w=0;w<A.redemptions.length;w++){var l=A.redemptions[w];var z="http://item.yhd.com/item/"+l.pmId;var v="¥"+l.price.money;var D=l.name;d.push("<p class='hd_gift'>");d.push("<span class='fr'>"+v+"</span>");d.push("<em>换购</em>");d.push("<a href='"+z+"' target='_blank' title='"+D+"'>"+D+"</a>");
d.push("<a href='javascript:void(0);' class='hd_gift_del' cartItemId='"+l.id+"'></a>");d.push("</p>")}}d.push("</dd>")}}for(var w=0;w<A.warningItems.length;w++){var e=A.warningItems[w];d.push("<dd class='hd_sold_out hd_cart_cur' disable='true' editable='false'>");d.push(ak(e,true,false));d.push("</dd>")}var F=0;var x=[];for(var r=0;r<A.itemGroups.length;r++){var c=A.itemGroups[r];var g=c.pricePromotions;F=F+g.length;for(var t=0;t<g.length;t++){x.push(g[t].promotion.displayName)}}F=F+A.reductCashes.length;for(var o=0;o<A.reductCashes.length;o++){x.push(A.reductCashes[o].promotion.displayName)}d.push("<dd class='clearfix hd_min_sum'>");if(F>0){d.push("<div class='fl'>");d.push("参加"+F+"项促销，共节约<b>¥"+A.summary.deduction+"</b><u></u>");d.push("<div class='hd_sale_show'>");d.push("<i></i>");for(var B=0;
B<x.length;B++){d.push("<p>"+x[B]+"</p>")}d.push("</div>");d.push("</div>")}d.push("<span class='fr hd_freight'>运费<i>¥"+(A.summary.deliveryFee!=null?A.summary.deliveryFee:0)+"</i></span>");if(A.yhdMerchant==true){d.push("<em class='fr'>"+A.summary.weight+"KG</em>")}d.push("</dd>");d.push("</dl>")}return d.join("")};var az=function(b){var a=[];if(b){if(!b.summary){var c=aC.cookie("ut");if(c){a.push("<div class='hd_none_tips'>");a.push("<span class='hd_none_icon'></span>");a.push("<p class='hd_none_text'>您的购物车里还没有1号店的商品哦~~</p>");a.push("</div>")}else{a.push("<div class='hd_login_tips'>");a.push("<p>登录才能看得到购物车里的商品哦~</p>");a.push("<a href='javascript:void(0);' id='miniCartLogin'>登录</a>");a.push("</div>")}return}a.push("<div class='hd_cart_scrollwrap'>");a.push(ay());a.push("<div class='hd_cart_list'>");
a.push(aL(b));a.push("</div>");a.push("<p class='hd_feedback' data-tpc='11'>");a.push("<em></em><a class='blue_link' href='http://yihaodian.sojump.com/jq/5279459.aspx' target='_blank'>意见反馈</a>");a.push("</p>");a.push("</div>");a.push("<div class='hd_bottom_tips' style='display:none;'>");a.push("<i></i><em></em><u></u><p></p>");a.push("</div>");a.push("<div class='hd_total_pro' data-tpc='10'>");a.push("<div class='fl'>");a.push("<span class='hd_all_select'><a href='javascript:void(0);' class='hd_select_box' id='miniCartSeltAll'></a><i>全选</i></span>");a.push("合计<b><em></em></b><p class='hd_point_num'><u></u></p>");a.push("</div>");a.push("<a class='fr' href='javascript:void(0);' id='miniCartPaybtn'>立即结算</a>");a.push("</div>");a.push("<div class='hd_area_mask none'></div>");a.push("<form method='post' id='miniCartForm' style='display:none;'>");
a.push("<input name='cart2Checkbox' type='hidden' value=''/>");a.push("<input name='cartSuppress' type='hidden' value=''/>");a.push("</form>")}else{var c=aC.cookie("ut");if(c){a.push("<div class='hd_none_tips'>");a.push("<span class='hd_none_icon'></span>");a.push("<p class='hd_none_text'>您的购物车里还没有1号店的商品哦~~</p>");a.push("</div>")}else{a.push("<div class='hd_login_tips'>");a.push("<p>登录才能看得到购物车里的商品哦~</p>");a.push("<a href='javascript:void(0);' id='miniCartLogin'>登录</a>");a.push("</div>")}}return a.join("")};var T=function(d,f){var h=URLPrefix.pms+"/pms/getRecommProductsByJson.do?callback=?";var b=0;var g=0;var c=function(){var q=aC("#addCartPopWin");var m=aC("a.hd_show_pre",q);var p=aC("a.hd_show_next",q);var l=q.find("div.hd_recommend_list ul");var o=q.find("div.hd_recommend_list").width()+15;
var i=aC("div.hd_recommend_list li",q).size();var j=4;var n=(i%j==0)?Math.floor(i/j):Math.floor(i/j)+1;var k=1;if(n>1){p.show();m.click(function(){if(k>1){l.animate({left:"-"+(k-2)*o+"px"},function(){k--;if(k<n){p.show()}if(k==1){m.hide()}})}else{m.hide();p.show()}});p.click(function(){if(k<n){l.animate({left:"-"+(k)*o+"px"},function(){k++;if(k>1){m.show()}if(k==n){p.hide()}})}else{m.show();p.hide()}})}};var a=function(o){if(b){clearTimeout(b)}if(g){return}var m=[];m.push("<div id='addCartPopWin' class='hd_cart_pop'>");m.push("<div class='hd_pop_content'>");m.push("<span class='hd_colse_btn' onclick='javascript:yhdLib.popclose();'></span>");if(d.code=="00000000"){m.push("<p class='hd_pop_tips'><i></i>已成功加入购物车</p>");m.push("<div class='hd_pop_btn'>");m.push("<a href='javascript:addTrackPositionToCookie(\"1\",\"product_popup_jxgw\");yhdLib.popclose();' class='hd_btn_l' data-ref='product_popup_jxgw'>继续购物</a>");
m.push("<a href='http://cart.yhd.com/cart/cart.do?action=view' class='hd_btn_r' data-ref='product_popup'>查看购物车</a>");m.push("</div>")}else{m.push("<p class='hd_pop_tips'><i class='hd_error_icon'></i>加入购物车失败</p>");m.push("<div class='hd_error_tips'>");m.push(d.msg);m.push("</div>")}if(o){m.push("<div class='hd_recommend_wrap'>");m.push("<p>更多商品推荐</p>");m.push("<div class='hd_recommend_list'>");m.push("<ul class='clearfix'>");for(var n=0;n<o.length;n++){var q=o[n];var p=q.linkUrl;var l=q.trackerCode;var k=at(q.picUrl,85,85);var i=q.cnName;var j=q.salePrice;m.push("<li>");m.push("<a href='"+p+"' target='_blank' data-ref='"+l+"' class='hd_pop_img'><img src='"+k+"'></a>");m.push("<a href='"+p+"' target='_blank' data-ref='"+l+"' class='hd_pop_name'>"+i+"</a>");m.push("<b class='hd_pop_price'>&yen;"+j+"</b>");
m.push("</li>")}m.push("</ul>");m.push("</div>");m.push("<a href='javascript:void(0);' class='hd_show_pre none'></a>");m.push("<a href='javascript:void(0);' class='hd_show_next none'></a>");m.push("</div>")}m.push("</div>");m.push("</div>");yhdLib.popwin({popcontentstr:m.join("")});g=1;c()};var e={currSiteId:currSiteId,provinceId:af,productid:f.productId,merchantId:f.merchantId,type:"html"};aC.getJSON(h,e,function(i){if(i&&i.success=="1"){a(i.value)}else{a(0)}});var b=setTimeout(function(){a(0)},5*1000)};var V=function(){var a=aC("#miniCart div.hd_cart_scrollwrap");var c=aC(window).height(),d=aC(window).scrollTop(),e=aw.offset().top,b=c-(e-d)-aC("#miniCart div.hd_total_pro").outerHeight();a.css("height",b)};var aK=function(c,a){var d=c.find("div.hd_over_tips");var b=c.find("div.hd_cart_wrap");
d.find("p").text(a);d.slideDown(500);b.css("z-index",1201);setTimeout(function(){d.slideUp(500);b.css("z-index",1200)},3000)};var aJ=function(a){var b=aC("#miniCart div.hd_bottom_tips");b.find("p").html(a);b.show()};var Z=function(){var f="http://buy.yhd.com/checkoutV3/index.do";var a=W.find("div.hd_cart_list dd[productId]");var j=0;var e=0;var c=0;var i=0;a.each(function(){var l=aC(this);var k=false;if(l.get(0).getAttribute("checked")=="true"){k=true}c++;if(l.attr("productType")==4&&k&&l.attr("disable")=="false"){j++}if((l.attr("checkoutType")==2||l.attr("checkoutType")==1)&&k&&l.attr("disable")=="false"){e++}if(k){i++}});if(j>0&&e==0&&j<i){aJ("结算商品中包含礼品卡，需前往<a href='"+aB+"/cart/cart.do?action=view' class='blue_link'>购物车</a>分开结算");return false}if(e>0&&j==0&&e<i){aJ("结算商品中包含海购商品，需前往<a href='"+aB+"/cart/cart.do?action=view' class='blue_link'>购物车</a>分开结算");
return false}if(j>0&&e>0){aJ("结算商品中包含海购商品和礼品卡，需前往<a href='"+aB+"/cart/cart.do?action=view' class='blue_link'>购物车</a>分开结算");return false}if(i==0){return false}var d=W.find("div.hd_cart_list dd a.hd_select_box");var g=[];d.each(function(){var m=aC(this);var k=m.parents("dd").attr("cartItemId");var l=m.hasClass("hd_selected")?1:0;g.push(k+"="+l)});var h=aC("#miniCartForm").get(0);h.action=f;h.cart2Checkbox.value=g.join(",");var b=function(l){if(l.result==1){h.submit()}else{if(yhdPublicLogin){var k=URLPrefix.passport;yhdPublicLogin.showLoginDivNone(k,false,"",function(m){if(m==0){aC("#miniCartForm").submit()}})}}};al.globalCheckLogin(b)};var av=function(c,d){if(!c){return}var b=aB+"/cart/opt/getCitysByProvince.do?callback=?";var a=function(f){var j=[];j.push("<dl class='clearfix'>");for(var i=0;
i<f.length;i++){var k=f[i];j.push("<dd><a data-value='"+k.id+"' href='javascript:;'>"+k.name+"</a></dd>")}j.push("</dl>");var h=W.find("div.yhd_province div.yhd_area_tab span:eq(1)");var g=W.find("div.yhd_province div.yhd_area_box div.yhd_second_area");g.html(j.join(""));h.attr("data-loaded",1);if(d){d(f)}};var e={provinceId:c};aC.getJSON(b,e,function(f){if(f&&f.code=="00000000"){a(f.data)}})};var aF=function(c,d){if(!c){return}var a=aB+"/cart/opt/getCountysByCity.do?callback=?";var b=function(f){var j=[];j.push("<dl class='clearfix'>");for(var i=0;i<f.length;i++){var k=f[i];j.push("<dd><a data-value='"+k.id+"' href='javascript:;'>"+k.name+"</a></dd>")}j.push("</dl>");var h=W.find("div.yhd_province div.yhd_area_tab span:eq(2)");var g=W.find("div.yhd_province div.yhd_area_box div.yhd_third_area");
g.html(j.join(""));h.attr("data-loaded",1);if(d){d(f)}};var e={cityId:c};aC.getJSON(a,e,function(f){if(f&&f.code=="00000000"){b(f.data)}})};var aD=function(a){var b=aB+"/cart/info/minicart.do?callback=?";aC.getJSON(b,function(c){if(c&&c.code=="00000000"){W.data("miniCartData",c.data);a(c.data)}else{a(null)}})};var ah=function(p,g,m){if(!p||p.productId==null||p.amount==null){return}var o=p.amount;var c=p.isFloat;var h=p.merchantId;var a=p.productId;var k=p.pmId||"";var q=p.ybPmIds||"";var d=p.showPrice||"";var n=p.needTip||"";var l=p.linkPosition||"";var i=p.referrer||encodeURIComponent(document.referrer);var f=aB+"/cart/opt/add.do?callback=?";var j=function(r){if(c){aA(W,null,function(){Y()},200)}else{if(!p.isDeleteNewDiv){T(r,p)}W.data("cart-item-loaded",0)}if(g){g(r)}aG.addItemCallback(p,r)
};var e=function(u){if(u&&u.code){var r=u.code;if(r=="300010801005"){var t=u.data;if(t&&t.indexOf("http")==0){window.location.href=t}else{window.location.href=currDomain+t}}else{if(r=="300010800001"){var s=URLPrefix.passport;yhdPublicLogin.showLoginDivNone(s,false,"",function(v){if(v==0){yhdPublicLogin.showTopLoginInfo()}})}else{T(u,p)}}}if(m){m(u)}aG.addItemFailback(p,u)};var b={productId:a,merchantId:h,num:o,pmId:k,ybPmIds:q,showPrice:d,needTip:n,pageRef:i,linkPosition:l};aG.getJSON(f,b,function(r){if(r&&r.code=="00000000"){j(r)}else{e(r)}})};var ap=function(f,a,c){if(!f||f.productId==null){return}var g=f.productId;var b=f.merchantId;var e=f.ybPmIds;var j=aB+"/cart/phone/isContractProduct.do?callback=?";var d=function(k){if(a){a(k)}};var i=function(k){if(c){c(k)}};var h={productId:g,merchantId:b,ybPmIds:e?e:""};
aG.getJSON(j,h,function(k){if(k.ERROR){i(k)}else{d(k)}})};var ad=function(h,f,b){if(!h||h.itemIds==null){return}var g=aB+"/cart/info/minicartDeleteItem.do?callback=?";var d=h.itemIds.join(",");var c=function(i){if(W.data("cart-item-loaded")){aD(ae)}if(f){f(i)}aG.removeItemCallback(h,i)};var a=function(j){var k=W.find("div.hd_cart_list dd[cartItemId='"+h.itemId+"']");var i=j.msg;if(k.size()>0){i=i.replace("["+k.find("a.hd_pro_name").text()+"]","");aK(k,i)}if(b){b(j)}aG.removeItemFailback(h,j)};var e={deleteId:d};aG.getJSON(g,e,function(i){if(i&&i.code=="00000000"){c(i)}else{a(i)}})};var aj=function(b,f,e){if(!b||b.itemId==null||b.pmId==null||b.num==null||b.itemType==null){return}var d=aB+"/cart/info/minicartEditNum.do?callback=?";if(b.itemType==10){d=aB+"/cart/info/minicartEditPointNum.do?callback=?"
}else{if(b.itemType==9){d=aB+"/cart/info/minicartEditLandingNum.do?callback=?"}}var c=function(h){if(W.data("cart-item-loaded")){aD(ae)}if(f){f(h)}aG.updateItemCallback(b,h)};var g=function(j){var k=W.find("div.hd_cart_list dd[cartItemId='"+b.itemId+"']");var h=j.msg;h=h.replace("["+k.find("a.hd_pro_name").text()+"]","");aK(k,h);var i=k.find("div.hd_num_box input");i.val(k.attr("itemNum"));if(e){e(j)}aG.updateItemFailback(b,j)};var a={cartItemVoId:b.itemId,pmInfoId:b.pmId,num:b.num};if(b.itemType==9){a.promotionId=b.promotionId}aG.getJSON(d,a,function(h){if(h&&h.code=="00000000"){c(h)}else{g(h)}})};var am=function(a,e,h){if(!a||a.length==0){return}var d=aB+"/cart/info/minicart.do?callback=?";var f=[];for(var i=0;i<a.length;i++){f.push(a[i].itemId+"="+a[i].checked)}var c=function(j){if(W.data("cart-item-loaded")){W.data("miniCartData",j.data);
ae(j.data)}if(e){e(j)}aG.chooseItemCallback(a,j)};var g=function(j){if(W.data("cart-item-loaded")){aD(ae)}if(h){h(j)}aG.chooseItemFailback(a,result)};var b={checkboxStr:f.join(",")};aG.getJSON(d,b,function(j){if(j&&j.code=="00000000"){c(j)}else{g(j)}})};var ax=function(g,f,e){if(!g||g.productIds==null||g.productIds.length==0){return}var c=aB+"/cart/opt/getSubProductSerialAttr.do?callback=?";var d=function(k){if(k.data&&k.data.subProductIdToAttributeValueMap){var n=k.data.subProductIdToAttributeValueMap;for(var h=0;h<g.productIds.length;h++){var l=W.find("div.hd_cart_list dd[productId='"+g.productIds[h]+"'] p.hd_subcode");var j=n[g.productIds[h]];if(l.size()>0&&j){var m="";for(var i=0;i<j.length;i++){m+="<span>"+j[i].attributeValueAlias+"</span>&nbsp;"}l.html(m)}}}if(f){f(k)}};var a=function(h){if(e){e(h)
}};for(var b=0;b<g.productIds.length;b++){c+="&subProductIds="+g.productIds[b]}aC.getJSON(c,null,function(h){if(h&&h.code=="00000000"){d(h)}else{a(h)}})};var aH=function(f){if(!f||!f.summary){return}var d=[];for(var b=0;b<f.bags.length;b++){var h=f.bags[b];for(var a=0;a<h.itemGroups.length;a++){var e=h.itemGroups[a];for(var c=0;c<e.items.length;c++){var g=e.items[c];if(g.productType==2){d.push(g.productId)}}}}ax({productIds:d})};var an=function(o){aC("div.hd_bottom_tips",W).hide();if(!o||!o.summary){ac.hide();W.find("div.hd_total_pro span.hd_all_select a").removeClass("hd_selected");W.find("div.hd_total_pro a.fr").text("立即结算(0)");W.find("div.hd_total_pro div.fl em").text("¥0");W.find("div.hd_total_pro div.fl u").text("");W.find("div.hd_total_pro").removeClass("hd_has_point");return}var l=parseInt(o.summary.count);
if(l>0){ac.text(l>999?"999+":l);ac.show()}else{ac.hide()}if(l>0){aC.cookie("cart_num",l,{domain:no3wUrl,path:"/",expires:10})}var m=0;for(var t=0;t<o.bags.length;t++){var n=o.bags[t];for(var u=0;u<n.itemGroups.length;u++){var p=n.itemGroups[u];for(var a=0;a<p.items.length;a++){var r=p.items[a];if(r.checked){m=m+r.num}for(var i=0;i<r.nestedItems.length;i++){var e=r.nestedItems[i];if(e.typeValue==10||e.typeValue==11){m+=e.num}}}for(var c=0;c<p.gifts.length;c++){var d=p.gifts[c];m=m+d.num}}for(var g=0;g<n.gifts.length;g++){var d=n.gifts[g];m=m+d.num}for(var h=0;h<n.redemptions.length;h++){var k=n.redemptions[h];m=m+k.num}}var b=parseFloat(o.summary.amount.money)+parseFloat(o.summary.deliveryFee!=null?o.summary.deliveryFee:0);var s=parseFloat(o.summary.amount.points);if(b%1>0){b=b.toFixed(2)}if(s%1>0){s=s.toFixed(2)
}var j="";if(b>0){j="¥"+b}else{j="¥0"}if(s>0){var f="+"+s+"积分";W.find("div.hd_total_pro").addClass("hd_has_point");W.find("div.hd_total_pro div.fl u").text(f)}else{W.find("div.hd_total_pro").removeClass("hd_has_point");W.find("div.hd_total_pro div.fl u").text("")}W.find("div.hd_total_pro a.fr").text("立即结算("+m+")");W.find("div.hd_total_pro div.fl em").text(j);if(m>0){aC("#miniCartPaybtn",W).addClass("hd_pay_btn")}else{aC("#miniCartPaybtn",W).removeClass("hd_pay_btn")}var q=true;if(o.bags.length==0){q=false}else{for(var t=0;t<o.bags.length;t++){var n=o.bags[t];for(var u=0;u<n.itemGroups.length;u++){var p=n.itemGroups[u];for(var a=0;a<p.items.length;a++){var r=p.items[a];if(!r.checked){q=false;break}}}}}if(q&&m>0){aC("#miniCartSeltAll",W).addClass("hd_selected")}else{aC("#miniCartSeltAll",W).removeClass("hd_selected")
}};var U=function(a){var b=az(a);aw.html(b);an(a);aH(a);V()};var ae=function(a){if(!a||!a.summary){U(a);return}var b=aL(a);aw.find("div.hd_cart_list").html(b);an(a);aH(a)};var Y=function(){var a=0;var b=function(d){if(W.data("cart-item-loaded")){if(W.find("div.hd_none_tips").size()>0||W.find("div.hd_login_tips").size()>0){U(d);W.data("cart-item-loaded",1)}else{ae(d)}}else{U(d);W.data("cart-item-loaded",1)}var c=function(){if(a){clearTimeout(a);a=0}};c();aC("#showMiniCartDetail").show();aC("#hdPrismWrap div.hd_prism").removeClass("hd_cur");a=setTimeout(function(){aC("#showMiniCartDetail").hide(1000);c()},2000);aC("#showMiniCartDetail").mouseenter(c)};aD(b)};var ao=function(){var i=W.find("div.yhd_province div.yhd_address");var f=W.find("div.yhd_province div.yhd_tab_detail");var h=W.find("div.hd_area_mask");
var j=W.find("div.yhd_province div.yhd_area_tab span");var a=W.find("div.yhd_province div.yhd_area_box div.yhd_item");if(i.hasClass("select")){return}var d=aC(j[0]).attr("data-value");var c=aC(j[1]).attr("data-value");var k=aC(j[2]).attr("data-value");var b=aC(j[1]).attr("data-loaded");var e=aC(j[2]).attr("data-loaded");if(c!=""&&b!=1){av(d)}if(k!=""&&e!=1){aF(c)}i.addClass("select");f.slideDown();h.show();var g=aC("div.hd_cart_scrollwrap",W).outerHeight();if(g>aC("div.hd_cart_list",W).height()+aC("div.yhd_province",W).outerHeight()){f.css("width","334px")}else{f.css("width","317px")}aC("div.hd_cart_scrollwrap",W).css("position","static")};var aa=function(){var b=W.find("div.yhd_province div.yhd_address");var a=W.find("div.yhd_province div.yhd_tab_detail");var c=W.find("div.hd_area_mask");b.removeClass("select");
a.slideUp();c.hide();aC("div.hd_cart_scrollwrap",W).css("position","relative")};var ai=function(f,a,d,e){var b=function(){var h=/^[1-9]\d{0,2}$/g;if(!h.test(e.val())){aK(f,"输入的数量有误,应为[1-999]");e.val(f.attr("itemNum"));return false}var g=parseInt(e.val());if(g>1){a.removeClass("hd_minus_disable").addClass("hd_minus")}if(g>=999){d.removeClass("hd_plus").addClass("hd_plus_disable")}if(g<=1){a.removeClass("hd_minus").addClass("hd_minus_disable")}if(g<999){d.removeClass("hd_plus_disable").addClass("hd_plus")}return true};var c=function(){var g=f.attr("itemType");var i=e.val();if(g==2){i=0;var h=W.find("div.hd_cart_list dd[parentCartItemId='"+f.attr("parentCartItemId")+"']");h.each(function(){var j=aC(this).find("input.hd_minicart_num");i=i+parseInt(j.val())})}aj({itemId:f.attr("cartItemId"),pmId:f.attr("pmId"),itemType:f.attr("itemType"),promotionId:f.attr("promotionId"),num:i})
};aA(aC(this),b,c,500)};var ar=function(b){var a=function(d){var c=parseInt(d.code);if(c==1){if(aC("#validateProductId").length>0){aC("#validateProductId").attr("value",productId)}if(aC.cookie("prompt_flag")==null&&aC("#buyPromptDiv").length>0){YHD.popwinId("buyPromptDiv");aC("#validate").bind("click",function(){window.location.href=URLPrefix.productDetailHost+"/product/"+b.productId+"_"+b.merchantId})}else{window.location.href=URLPrefix.productDetailHost+"/product/"+b.productId+"_"+b.merchantId}}else{if(aC("#validateProductId").length>0){aC("#validateProductId").attr("value",productId)}if(aC.cookie("prompt_flag")==null&&aC("#buyPromptDiv").length>0){YHD.popwinId("buyPromptDiv","popwinClose");aC("#validate").bind("click",function(){ah(b,function(){YHDOBJECT.callBackFunc(b)})})}else{ah(b,function(){YHDOBJECT.callBackFunc(b)
})}}};ap(b,a)};var aq=function(){var b,a;W.mouseenter(function(){if(a){clearTimeout(a)}b=setTimeout(function(){aw.show();aC("#hdPrismWrap div.hd_prism").removeClass("hd_cur");if(!W.data("cart-item-loaded")){aD(U);W.data("cart-item-loaded",1)}else{V();aC("div.hd_cart_list dd div.hd_over_tips",W).hide();aC("div.hd_bottom_tips",W).hide()}},200)});W.mouseleave(function(){if(b){clearTimeout(b)}a=setTimeout(function(){aw.hide()},200)});W.delegate("div.hd_cart_scrollwrap","mousewheel",function(f,c){var e=aC(this).scrollTop();var g=aC(this).outerHeight();var d=aC("#miniCart .yhd_province").outerHeight()+aC("#miniCart .hd_cart_list").outerHeight()+aC("#miniCart .hd_feedback").outerHeight();if(g>d){f.preventDefault()}if(e==0&&(c>0)){f.preventDefault()}else{if(e==d-g&&(c<0)){f.preventDefault()}}});W.delegate("div.hd_total_pro","mousewheel",function(d,c){d.preventDefault()
});W.delegate("div.hd_area_mask,div.yhd_tab_detail","mousewheel",function(d,c){d.preventDefault()});W.delegate("div.yhd_province dd","mouseenter",function(){aC(this).addClass("hd_cart_cur")});W.delegate("div.yhd_province dd","mouseleave",function(){aC(this).removeClass("hd_cart_cur")});W.delegate("p.hd_gift","mouseenter",function(){aC(this).addClass("hd_gift_cur")});W.delegate("p.hd_gift","mouseleave",function(){aC(this).removeClass("hd_gift_cur")});W.delegate("div.hd_cart_list dd.hd_min_sum .fl","mouseenter",function(){aC(this).addClass("hd_sale_cur");var g=aC(this).position().top+60,c=aC("div.hd_cart_scrollwrap",W).scrollTop(),e=aC("div.hd_cart_scrollwrap",W).outerHeight(true),d=aC(this).find(".hd_sale_show").outerHeight(true),f=e-(g-c);if(f<d){aC(this).find(".hd_sale_show").addClass("hd_sale_showup")
}else{aC(this).find(".hd_sale_show").attr("class","hd_sale_show")}});W.delegate("div.hd_cart_list dd.hd_min_sum .fl","mouseleave",function(){aC(this).removeClass("hd_sale_cur")});W.delegate("div.hd_cart_list a.hd_cart_del","click",function(){aA(aC(this),null,function(){var c=aC(this).attr("cartItemId");ad({itemIds:[c]})},500);return false});W.delegate("div.hd_cart_list a.hd_gift_del","click",function(){aA(aC(this),null,function(){var c=aC(this).attr("cartItemId");ad({itemIds:[c]})},500);return false});W.delegate("div.hd_cart_list a.hd_plus","click",function(){var g=aC(this).parents("dd");var c=g.find("div.hd_num_box a:eq(0)");var e=g.find("div.hd_num_box a:eq(1)");var f=g.find("div.hd_num_box input");var d=parseInt(f.val());if(d>=999){d=999}else{d=d+1}f.val(d);ai(g,c,e,f);return false});W.delegate("div.hd_cart_list a.hd_minus","click",function(){var g=aC(this).parents("dd");
var c=g.find("div.hd_num_box a:eq(0)");var e=g.find("div.hd_num_box a:eq(1)");var f=g.find("div.hd_num_box input");var d=parseInt(f.val());if(d<=1){d=1}else{d=d-1}f.val(d);ai(g,c,e,f);return false});W.delegate("div.hd_cart_list input.hd_minicart_num","blur",function(){var d=aC(this).parents("dd");var e=d.find("div.hd_num_box a:eq(0)");var f=d.find("div.hd_num_box a:eq(1)");var c=d.find("div.hd_num_box input");ai(d,e,f,c);return false});W.delegate("div.hd_cart_list input.hd_minicart_num","keyup",function(d){var f=aC(this).parents("dd");var h=f.find("div.hd_num_box a:eq(0)");var c=f.find("div.hd_num_box a:eq(1)");var e=f.find("div.hd_num_box input");var g=d.keyCode;if(g=="13"){e.blur()}return false});W.delegate("div.hd_cart_list dd a.hd_select_box","click",function(){var d=aC(this).parents("dd");
var c=aC(this);if(d.attr("disable")=="true"){return false}var e=function(){var h=c.hasClass("hd_selected")?1:0;if(h){c.removeClass("hd_selected")}else{c.addClass("hd_selected")}if(d.attr("itemType")==2){var g=W.find("div.hd_cart_list dd[parentCartItemId='"+d.attr("parentCartItemId")+"']");g.each(function(){var i=aC(this).find("a.hd_select_box");if(aC(this).attr("cartItemId")!=d.attr("cartItemId")){if(h){i.removeClass("hd_selected")}else{i.addClass("hd_selected")}}})}};var f=function(){var h=W.find("div.hd_cart_list dd a.hd_select_box");var g=[];h.each(function(){var k=aC(this);var i=k.parents("dd").attr("parentCartItemId");var j=k.hasClass("hd_selected")?1:0;g.push({itemId:i,checked:j})});am(g)};aA(aC(this),e,f,500);return false});W.delegate("div.hd_cart_list dt a.hd_select_box","click",function(){var c=aC(this);
var d=aC(this).parents("dl").find("dd");var e=function(){var g=c.hasClass("hd_selected")?1:0;if(g){c.removeClass("hd_selected")}else{c.addClass("hd_selected")}d.each(function(i,h){if(aC(h).attr("disable")!="true"){if(g){aC(h).find("a.hd_select_box").removeClass("hd_selected")}else{aC(h).find("a.hd_select_box").addClass("hd_selected")}}})};var f=function(){var h=W.find("div.hd_cart_list dd a.hd_select_box");var g=[];h.each(function(){var k=aC(this);var i=k.parents("dd").attr("parentCartItemId");var j=k.hasClass("hd_selected")?1:0;g.push({itemId:i,checked:j})});am(g)};aA(aC(this),e,f,500);return false});W.delegate("div.hd_total_pro #miniCartSeltAll","click",function(){var c=aC(this);var d=W.find("div.hd_cart_list dd[productId]");var e=function(){var g=c.hasClass("hd_selected")?1:0;if(g){c.removeClass("hd_selected")
}else{c.addClass("hd_selected")}d.each(function(i,h){if(aC(h).attr("disable")!="true"){if(g){aC(h).find("a.hd_select_box").removeClass("hd_selected")}else{aC(h).find("a.hd_select_box").addClass("hd_selected")}}});W.find("div.hd_cart_list dt a.hd_select_box").each(function(){if(g){aC(this).removeClass("hd_selected")}else{aC(this).addClass("hd_selected")}})};var f=function(){var h=W.find("div.hd_cart_list dd a.hd_select_box");var g=[];h.each(function(){var k=aC(this);var i=k.parents("dd").attr("parentCartItemId");var j=k.hasClass("hd_selected")?1:0;g.push({itemId:i,checked:j})});am(g)};aA(aC(this),e,f,500);return false});aw.delegate(".hd_bottom_tips u","click",function(){aC(this).parents(".hd_bottom_tips").hide()});W.delegate("div.hd_total_pro #miniCartPaybtn","click",function(){Z();return false
});W.delegate("div.yhd_province div.yhd_address","click",function(){ao();return false});W.delegate("div.yhd_province span.yhd_close_btn","click",function(){aa();return false});W.delegate("div.yhd_province div.yhd_area_tab span","click",function(){var d=W.find("div.yhd_province div.yhd_area_tab span");var c=W.find("div.yhd_province div.yhd_area_box div.yhd_item");var e=aC(this).index();d.eq(e).addClass("yhd_on").siblings().removeClass("yhd_on");c.hide().eq(e).show();return false});W.delegate("div.yhd_province div.hd_first_area dd a","click",function(){var d=aC(this).attr("data-value");var c=aC(this).text();var e=function(){var f=W.find("div.yhd_province div.yhd_area_tab span");var g=W.find("div.yhd_province div.yhd_area_box div.yhd_item");aC(f[0]).attr("data-value",d);aC(f[0]).find("em").text(c);
f.eq(1).addClass("yhd_on").siblings().removeClass("yhd_on");g.hide().eq(1).show();aC(f[1]).attr("data-value","");aC(f[1]).find("em").text("请选择市");aC(f[2]).attr("data-value","");aC(f[2]).find("em").text("请选择区");aC(g[2]).html("")};av(d,e);return false});W.delegate("div.yhd_province div.yhd_second_area dd a","click",function(){var d=aC(this).attr("data-value");var c=aC(this).text();var e=function(){var f=W.find("div.yhd_province div.yhd_area_tab span");var g=W.find("div.yhd_province div.yhd_area_box div.yhd_item");aC(f[1]).attr("data-value",d);aC(f[1]).find("em").text(c);f.eq(2).addClass("yhd_on").siblings().removeClass("yhd_on");g.hide().eq(2).show()};aF(d,e);return false});W.delegate("div.yhd_province div.yhd_third_area dd a","click",function(){var d=W.find("div.yhd_province div.yhd_area_tab span");
var c=aC(this).attr("data-value");var h=aC(this).text();aC(d[2]).attr("data-value",c).find("em").text(h);var f=[aC(d[0]).attr("data-value"),aC(d[1]).attr("data-value"),aC(d[2]).attr("data-value")];var e=[aC(d[0]).find("em").text(),aC(d[1]).find("em").text(),aC(d[2]).find("em").text()];var g=W.find("div.yhd_province div.yhd_address span");g.attr("data-value",f.join("_"));g.text(e.join("|"));ab([f,e]);aa();if(af!=f[0]){setAddressCity(f[0])}});W.delegate("#miniCartLogin","click",function(){if(yhdPublicLogin){yhdPublicLogin.showLoginDiv()}})};aG.initCart=function(){if(W.data("cart-num-loaded")){return}W.data("cart-num-loaded",1);X();aq()};aG.reloadCart=function(){if(W.data("cart-item-loaded")){aD(U)}};aG.reloadCartItems=function(){if(W.data("cart-item-loaded")){aD(ae)}};aG.reloadCartFloat=function(){Y()
};aG.addItem=function(a){ar(a)};aG.removeItem=function(c,b,a){ad(c,b,a)};aG.updateItem=function(c,b,a){aj(c,b,a)};aG.chooseItem=function(c,b,a){am(c,b,a)};aG.changeAddress=function(b){if(!b||b.length!=2){return}var d=b[0];var e=b[1];var c=W.find("div.yhd_province div.yhd_address span");c.attr("data-value",d.join("_"));c.text(e.join("|"));var a=W.find("div.yhd_province div.yhd_area_tab span");aC(a[0]).attr("data-loaded",0).attr("data-value",d[0]).find("em").text(e[0]);aC(a[1]).attr("data-loaded",0).attr("data-value",d[1]).find("em").text(e[1]);aC(a[2]).attr("data-loaded",0).attr("data-value",d[2]).find("em").text(e[2]);ab([d,e]);if(af!=d[0]){setAddressCity(d[0])}};aG.initCart()})(jQuery);function addToCart(j,k,h,m,n,i){var l={};l.amount=m;l.isFloat=n;l.linkPosition=i;l.merchantId=h;addToCartNew(j,k,l)
}function addToCartNew(e,f,d){d.productId=f;loli.app.minicart.addItem(d)}function initAllMiniCart(){}function loadMiniCart(){loli.app.minicart.reloadCart()}function reloadMiniCart(){loli.app.minicart.reloadCart()};