(function(a){a(function(){var i=window.loli||(window.loli={});var c=i.app=i.app||{};var f=i.app.account=i.app.account||{};var e=a.cookie("provinceId");var h=a.cookie("yihaodian_uid");var j=(typeof globalTopPrismFlag!="undefined"&&globalTopPrismFlag=="0")?0:1;var l=a("#global_login");var k=l.attr("data-mpIcon")!=""?a.parseJSON(l.attr("data-mpIcon")):null;if(!h||!e){return}var b=function(){var o=URLPrefix.central+"/homepage/ajaxFindPrismMemberUserInfo.do?callback=?";var n=function(q){var r=g(q);l.html(r);l.data("userInfo",q);m()};var p={userId:h,currSiteId:(typeof currSiteId=="undefined")?1:currSiteId,currSiteType:1,provinceId:e};a.getJSON(o,p,function(q){var s=q;if(s){if(s.status==1){var r=s.userInfo;n(r)}}})};var d=function(n){if(n!=null&&n!=""){n=n.replace(/\&/g,"&amp;");n=n.replace(/\</g,"&lt;");
n=n.replace(/\>/g,"&gt;");n=n.replace(/\\/g,"&#92;");n=n.replace(/\'/g,"&#039;");n=n.replace(/\"/g,"&#034;")}return n};var g=function(s){if(!s){return}var C=URLPrefix.statics+"/global/images/top/peopleicon_01.gif";var t=URLPrefix.statics+"/global/images/top/peopleicon_02.gif";var v="http://my.yhd.com/member/my.do";var H="http://vip.yhd.com";var p="http://jifen.yhd.com/pointshop/pointIndex.do";var E="http://my.yhd.com/member/userinfo/editinfo.do";var B="http://vip.yhd.com/badge-shop/index.html";var n="http://edm.yhd.com/pcMsg/myMessage.action";var z=s.endUserCredit?s.endUserCredit:0;var D=s.exp?s.exp:0;var r=s.nextGradeExpNeed;var o=s.memberGrade?s.memberGrade:0;var x=s.endUserPic;var F=d(s.endUserName);var w=s.badgesNum?s.badgesNum:0;var u=s.msgsNum?s.msgsNum:0;var y=s.samFlag?s.samFlag:0;if(o==null||o<0||o>3){o=0
}var q=0;if(D<1){q=0}else{if(D<1000){q=D/10}else{if(D<3000){q=D/30}else{q=D>=10000?75:D/10000*0.75*100}}}var G="";if(k!=null&&k.imgUrl!=""){G+="<img src='"+k.imgUrl+"' alt='"+(k.altName||"")+"'>"}var A=[];A.push("<div class='hd_login clearfix'>");A.push("<span class='hd_hi'>Hi,</span>");A.push("<a href='"+H+"' target='_blank' class='hd_vip "+("hd_vip"+o)+"' data-ref='YHD_TOP_username_vip'></a>");A.push("<a href='"+v+"' target='_blank' class='hd_login_name fl' data-ref='YHD_TOP_myyihaodian'>"+F+"</a>");A.push("</div>");A.push("<div class='hd_user_center'>");A.push("<a href='javascript:bothSiteLogoutJsonp();' class='blue_link'>退出登录</a>");A.push("<div class='clearfix'>");A.push("<div class='fl'>");A.push("<a class='hd_avata_box' href='"+v+"' target='_blank' data-ref='YHD_TOP_userpic'>");A.push(x?"<img src='"+x+"'>":"");
A.push("</a>");A.push("<a href='"+E+"' target='_blank' data-ref='YHD_TOP_userinfo'>个人资料</a>");A.push("</div>");A.push("<div class='hd_growth_box'>");A.push("<p><a class='hd_user_name' href='"+v+"' target='_blank' data-ref='YHD_TOP_myyihaodian'>"+F+"</a>&nbsp;");A.push("<a class='hd_vip "+("hd_vip"+o)+"' href='"+H+"' target='_blank' data-ref='YHD_TOP_username_vip'></a>");if(y){A.push("<a title='山姆会员' class='hd_sam_vip' href='javascript:;' data-ref='YHD_TOP_usersamicon'></a>")}A.push("</p>");A.push("<p>当前成长值：<a class='hd_login_wrap_arrow' href='"+H+"' target='_blank' data-ref='YHD_TOP_userexp'>"+D+"</a></p>");A.push("<div class='hd_growth_progress'><p class='hd_progress_bar' style='width:"+q+"%'><i></i></p></div>");A.push("</div>");A.push("</div>");A.push("<div class='hd_message'>");A.push("<a href='"+p+"' target='_blank' data-ref='YHD_TOP_userjifen'>");
A.push("<b>"+z+"</b>");A.push("<span class='hd_point'>积分<em>"+G+"</em></span>");A.push("</a>");A.push("<a href='"+H+"' target='_blank' data-ref='YHD_TOP_userxunzhang'>");if(o==0||o==3){A.push("<b>0元</b>");A.push("<span>会员价</span>")}else{A.push("<b>19.9元</b>");A.push("<span>会员价</span>")}A.push("</a>");A.push("<a href='"+n+"' target='_blank' data-ref='YHD_TOP_usermsg'>");A.push("<b>"+u+"</b>");A.push("<span>消息</span>");A.push("</a>");A.push("</div>");A.push("</div>");A.push("<em class='hd_login_arrow'></em>");return A.join("")};var m=function(){var n=null;l.hover(function(){var o=i.spm.getData(this);gotracker("2","logintopbarHover",null,o);if(n!=null){clearTimeout(n)}n=setTimeout(function(){l.addClass("hd_login_hover")},200)},function(){if(n!=null){clearTimeout(n)}n=setTimeout(function(){l.removeClass("hd_login_hover")
},200)});l.show();a("#global_unlogin").hide()};f.showUserInfo=function(n){if(j){if(n&&n.result==1){b()}}else{if(n&&n.result==1){var o={endUserName:n.userName,endUserPic:n.endUserPic,endUserSex:n.endUserSex,memberGrade:n.memberGrade,exp:0,nextGradeExpNeed:0,endUserCredit:0,badgesNum:0,msgsNum:0};var p=g(o);l.html(p);l.data("userInfo",o);m()}}};if(l.size()>0&&l.attr("data-type")!=null){i.globalCheckLogin(f.showUserInfo)}})})(jQuery);