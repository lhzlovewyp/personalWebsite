(function(d){function b(j,h){var l=null;var i=j[h];var k=i!=null?i:[];for(var n=0;n<k.length;n++){var m=k[n];if(m&&m.commonScreenImgUrl){l=m;break}}return l}function g(i,h){if(i.attr("data-done")=="1"){return}i.attr("href",h.landingPage).attr("title",h.text).attr("data-done","1").attr("data-ref",h.ref);d("b",i).text(h.text);d("p",i).text(h.nameSubtitle)}function e(i,h){if(i.attr("data-done")=="1"){return}i.attr("alt",h.text).attr("src",h.commonScreenImgUrl).attr("data-done","1");if(i.attr("shortimg")!=null){i.attr("shortimg",h.commonScreenImgUrl)}if(i.attr("wideimg")!=null){i.attr("wideimg",h.commonScreenImgUrl)}if(i.attr("si")!=null){i.attr("si",h.commonScreenImgUrl)}if(i.attr("wi")!=null){i.attr("wi",h.commonScreenImgUrl)}if(i.attr("original")!=null){i.attr("original",h.commonScreenImgUrl)
}}function c(i,j){if(i.size()==0){return}var r=i.data("advsData");var h=i.data("doneAdvCodes")!=null?i.data("doneAdvCodes").split(","):[];if(r!=null){for(var n=0;n<j.length;n++){var k=b(r,j[n]);var q=false;for(var m=0;m<h.length;m++){if(h[m]==j[n]){q=true;break}}if(!q&&k!=null){var p=d("body a[data-advId="+k.regionId+"]");var o=d("body img[data-advId="+k.regionId+"]");if(p.size()>0){for(var l=0;l<p.size();l++){g(p.eq(l),k);e(o.eq(l),k)}h.push(j[n]);i.data("doneAdvCodes",h.join(","))}}}}}function f(k){var p,l,j,h,i;var o=typeof isWidescreen!="undefined"?isWidescreen:false;var m=function(){if(!k||k.size()==0){return}p=k.val();l=(p&&p.length>0)?p.split(","):[];h=(typeof currSiteId=="undefined")?1:currSiteId;j=d.cookie("provinceId");n()};var q=function(t,s){var r="http://p4p.yhd.com/advdolphin/external/saleTypeWeightAd?callback=?";
var u={mcSiteId:h,provinceId:j,codes:t,categoryIds:s,screenType:o?"1":"2"};d.getJSON(r,u,function(v){if(v&&v.status==1){var w=v.value;if(w){var x=k.data("advsData");if(x==null){k.data("advsData",w)}else{x=d.extend(x,w);k.data("advsData",x)}c(k,l)}}})};var n=function(){var r=[];for(var s=0;s<l.length;s++){r.push(l[s]);if(r.length>=20){q(r.join(","),"");r=[]}}if(r.length>0){q(r.join(","),"")}};m()}var a=window.loli||(window.loli={});a.cpm=a.cpm||{};a.cpm.initAjaxReplaceAdvertise=function(h){new f(h)}})(jQuery);