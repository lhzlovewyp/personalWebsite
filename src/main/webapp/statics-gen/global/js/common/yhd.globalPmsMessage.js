(function(b){b(function(){if(typeof(pmsInterfaceCallFlag)!="undefined"&&pmsInterfaceCallFlag=="0"){return}var m=YHDOBJECT.globalVariable().globalPageCode;if(typeof(m)=="undefined"||m==-1){return}var l=window.loli||(window.loli={});l.app=l.app||{};var s=l.app.pms=l.app.pms||{};var r=b.cookie("yihaodian_uid")||undefined,q=URLPrefix.pms,n=URLPrefix.statics+"/global/images/blank.gif";var o=function(){var c={hasWideScreen:(typeof isWidescreen!="undefined"&&isWidescreen==true)?true:false};if(m=="YHD_HOME"){c.hasWideScreen=true}return c},a=function(g){var ag=g.infoType,av=g.showTimes,e=g.lTrackerPrefix,ap=g.rTrackerPrefix,c=g.buttonTracker,al=g.sourceObject||[],ad=g.productList||[],at,i=[],ai=[],au=ad.length,ao=[],af="",ak=[],ae="",ac=0,ah;switch(ag){case 164:var f=c+"_"+r;at=al.length;ae='<div class="fixed_recommend_btn PMS_message_btn data-tk="'+f+'"><span class="recom_text">您关注的商品到货啦！</span></div>';
ah="根据到货商品为您推荐";for(var h=0;h<at;h++){var ay=al[h],k=ay.productId||0,aw=ay.cnName,az=ay.linkUrl,am=ay.picUrl||n,aq=ay.salePrice||0,aa=ay.yhdPrice||0,Y=e+"_"+k+"_"+h,d=typeof(az)=="undefined"?"":'href="'+az+'" data-tk="'+Y+'" target="_blank" ';i.push('<li><dl class="recom_product"><dd class="pic"><a '+d+'title="'+aw+'"><img src="'+am+'" width="115" height="115" alt="'+aw+'" /></a></dd>');i.push("<dt><a "+d+'title="'+aw+'">'+aw+"</a></dt>");i.push('<dd class="price"><strong>&yen;'+aq+"</strong>");if(aq!=aa){i.push("<del>&yen;"+aa+"</del>")}i.push('</dd><dd class="btn"><a '+d+'class="btn_add_cart">查看详情</a></dd></dl></li>')}i=i.join("");ai.push('<div class="recom_num_scroll_wrap"><div class="recom_num_scroll"><ul class="clearfix">'+i+'</ul></div><a class="scroll_arrow arrow_prev" href="javascript:void(0);"></a><a class="scroll_arrow arrow_next');
ai.push('" href="javascript:void(0);"></a><span class="scroll_num"><em class="cur">1</em>/<em class="total">'+at+"</em></span></div>");ai=ai.join("");ac=164;break;case 165:var ay=al[0],j=ay.activeId,aA=ay.deductType||1,Z=ay.threshOld||0,ar=ay.couponTitle,an=ay.couponLinkUrl,ax=ay.amount||0,ab=ay.expiredTime||"0000-00-00",f=c+"_"+r,aj,Y,d;if(currSiteId==1){aj="yhd"}else{if(currSiteId==2){aj="yw"}}Y=aj+"_pmsCoupon_"+j;d=typeof(an)=="undefined"?"":'href="'+an+'" data-tk="'+Y+'" target="_blank" ';ae='<div class="fixed_vouchers_btn PMS_message_btn"><a class="recom_text" href="'+an+'" target="_blank" data-blank_tk="'+Y+'">您有一张满'+Z;ah="除本品外，本券还适用于这些您可能需要的商品";ai.push('<div class="recom_vouchers_wrap"><dl><dd class="vouchers_text"><a '+d+'title="'+ar+'""><span class="meet">满');if(aA==1){ae+="元";ai.push('<strong class="yen">&yen;</strong><strong class="price">'+Z+" </strong>")
}else{if(aA==2){ae+="件";ai.push('<strong class="price">'+Z+" </strong>件")}}ae+="减"+ax+"元的抵用券！（将过期）</a></div>";ai.push('减</span><span class="reduce"><strong class="yen">&yen;</strong><strong class="price">'+ax+"</strong></span></a></dd>");ai.push('<dd class="text"><a '+d+'title="'+ar+'">'+ar+"</a></dd>");ai.push('<dd class="expiry_date">到期时间：'+ab+"</dd></dl></div>");ai=ai.join("");ac=165;break;default:break}for(var h=0;h<au;h++){var X=ad[h],k=X.productId||0,aw=X.cnName,az=X.linkUrl,am=X.picUrl||n,aq=X.salePrice||0,aa=X.yhdPrice||0,Y=ap+"_"+k+"_"+h,d=typeof(az)=="undefined"?"":'href="'+az+'" data-tk="'+Y+'" target="_blank"';ao.push('<li><dl class="recom_product"><dd class="pic"><a '+d+'title="'+aw+'"><img src="'+am+'" width="115" height="115" alt="'+aw+'" /></a></dd>');ao.push("<dt><a "+d+'title="'+aw+'">'+aw+"</a></dt>");
ao.push('<dd class="price"><strong>&yen;'+aq+"</strong>");if(aq!=aa){ao.push("<del>&yen;"+aa+"</del>")}ao.push('</dd><dd class="btn"><a '+d+'class="btn_add_cart">查看详情</a></dd></dl></li>')}ao=ao.join("");af='<div class="recom_screen_scroll_wrap"><div class="recom_screen_scroll"><ul class="clearfix">'+ao+'</ul></div><a class="scroll_arrow arrow_prev" href="javascript:void(0);"></a><a class="scroll_arrow arrow_next" href="javascript:void(0);"></a><b class="icon_arrow"></b></div>';ak.push('<div class="fixed_recommend_main fixed_recommend_main_index wrap" id="globalPMSMessage"><div class="fixed_recommend_wrap"><div class="con"><h3>'+ah+'</h3><div class="box clearfix">'+ai+af+'</div></div><div class="transparent_bg"></div><span class="close"></span></div>');ak.push(ae+"</div>");ak=ak.join("");b("body").append(ak);
if(ac>0){recordTrackInfoWithType("1","pms_"+ac)}b("#globalPmsMessageBtn").click(function(){gotracker(2,b("#globalPmsMessageBtn").attr("data-tk"))});addTrackerToEvent(b("#globalPMSMessage .con"),"data-tk");addTrackerToEvent(b("#globalPMSMessage"),"data-blank_tk");p(ag,av)},p=function(c,A){var i=o().hasWideScreen,j=b("#globalPMSMessage"),e=j.find(".fixed_recommend_wrap"),k=j.find(".PMS_message_btn"),y=e.find(".close"),h=/msie ([\d\.]+)/.test(window.navigator.userAgent.toLowerCase())&&parseInt(/msie ([\d\.]+)/.exec(window.navigator.userAgent.toLowerCase())[1])<=6,z=screen.width>=1280?true:false,B=i?(z?5:4):4,d=false;k.animate({bottom:"-1px"},300);if(h){var g=b(window).height();l.delay(window,"scroll",null,function(){var u=b(window).scrollTop();j.css({top:g+u})})}k.click(function(){return;var u=b(this);
if(c==164){b.getJSON(q+"/pms/infoRemindClearCookie.do?callback=?")}u.animate({bottom:"-30px"},300,function(){e.show().animate({bottom:"0"},500);if(!d){switch(c){case 164:var w=new f({scrollId:".recom_num_scroll_wrap",scrollPic:".recom_num_scroll ul",picItem:"li",visible:"1",speed:300}),v=new f({scrollId:".recom_screen_scroll_wrap",scrollPic:".recom_screen_scroll ul",picItem:"li",visible:B,speed:600});w.slide();v.slide();break;case 165:var v=new f({scrollId:".recom_screen_scroll_wrap",scrollPic:".recom_screen_scroll ul",picItem:"li",visible:B,speed:600});v.slide();break;default:break}d=true}if(A==1){u.remove()}})});y.click(function(){e.animate({bottom:"-295px"},500,function(){if(A==0){e.hide();k.animate({bottom:"-1px"},300)}else{e.remove()}})});function f(u){this._config={scrollId:"",scrollPic:"",picItem:"",visible:"",speed:400,indexNum:0};
this.config=b.extend(this._config,u)}f.prototype.slide=function(){var V=this.config,P=V.visible,x=V.speed,X=b(V.scrollId),v=X.find(V.scrollPic),T=X.find(".scroll_arrow"),w=X.find(".arrow_prev"),u=X.find(".arrow_next"),Y=X.find(".scroll_num"),U=Y.find(".cur"),Q=v.find(V.picItem),aa=Q.length,Z=Q.outerWidth(true),W=Math.ceil(aa/P),ab=0,S=P*Z;if(W<=1){T.hide();Y.hide()}else{u.addClass("arrow_next_click")}X.delegate(".arrow_prev_click","click",function(){ab--;R(ab)});X.delegate(".arrow_next_click","click",function(){ab++;R(ab)});function R(C){U.text(C+1);if(C==0){w.removeClass("arrow_prev_click");u.addClass("arrow_next_click")}else{if(C==(W-1)){w.addClass("arrow_prev_click");u.removeClass("arrow_next_click")}else{w.addClass("arrow_prev_click");u.addClass("arrow_next_click")}}v.animate({marginLeft:-S*C},x)
}}},t=function(){var e={currSiteId:currSiteId,currSiteType:currSiteType,provinceId:b.cookie("provinceId")||undefined,pageCode:m,productid:b("#productId").val(),merchantId:b("#merchantId").val(),userid:r,searchCategoryId:b("#curCategoryIdToGlobal").val(),searchKeyword:b("#searchword").val(),isLogin:0},d=q+"/pms/infoRemind.do?",c=[];c.push(d);var f=function(i){e.isLogin=i.result;for(var h in e){var g=e[h];if(typeof(g)!=="undefined"){c.push(h+"="+e[h]+"&")}}c.push("callback=?");d=c.join("");b.getJSON(d,function(j){if(j){var k=j.value[0];if(k&&k&&k.status==1&&k.showFlag==1){a(k)}}})};l.globalCheckLogin(f)};s.message=t;setTimeout(function(){s.message()},3000)})})(jQuery);