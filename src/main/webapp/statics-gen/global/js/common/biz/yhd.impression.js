define("common_impression",["base_observer"],function(j){var f={};var i=[];function g(a){if(typeof(loli.page)=="undefined"){return}a=loli.page.checkTpPage(a);if(!a){return}return loli.page.glSpmcodeToId(null,a[0])}j.subscribe("impressionEvent",function(b){var w=b.attr("data-tpa");var s=document.documentElement.scrollTop||document.body.scrollTop;var e=jQuery("meta[name=tp_page]").attr("content");if(!e){return}var a=g(e);if(!a&&a!="0"){return}var z=e.split(".");var t=0;if(z.length>1){t=z[1]}var x=b.attr("data-ctpa");if(x){w=x}var c={scrollTop:s,w_pt:a,w_pv:t,w_tpa:w};var u=a+"_"+t;if(b){var v=b.data("extFlag");var d=b.attr("data-mrt")||0;if(v!="1"&&d==0){var y=window.loli||{};if(y&&y.extTrackerSend){loli.extTrackerSend.send({type:"1",info:w,others:"area.module",extend:u,paramObj:c})}else{recordTrackInfoWithType("1",w,"area.module",u,c)
}b.data("extFlag",1)}}});f.run=function(c){var b=200,a=null;if(c){i=c}if(i.length<1){i=jQuery("[data-tpa],[data-ctpa]")}setTimeout(function(){h()},500);jQuery(document).bind("scroll",function(){a&&clearTimeout(a);a=setTimeout(function(){h()},b)})};function h(){if(typeof(j)=="object"){var a=new Date().getTime();if(i.length>0){var b=[];var c=0;while(c<i.length){if(loli.isVisual(i[c])&&i[c]&&i[c].style&&i[c].style.display!="none"){j.fire("impressionEvent",jQuery(i[c]));i.splice(c,1)}else{c++}}}}}return f});